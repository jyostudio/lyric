var t={507:function(t,e,r){r.d(e,{u:function(){return s},A:function(){return wn}});class n{constructor(){this.state="future",this.text="",this.duration=0,this.progress=0,this.singleLine=!1,this.lineNo=0}get hasTiming(){return!this.singleLine&&(this.duration||0)>0}}class s{static updateByTime(t,e){return t.setCurrentTime(e)}static computeActiveWordIndex(t){if(!t||!t.words||0===t.words.length)return-1;try{if(!wn.supportsPerWord(t))return-1}catch{}const e=t.words;let r=e.findIndex(t=>"current"===t.state);if(-1!==r)return r;for(let t=e.length-1;t>=0;t--)if("past"===e[t].state)return t;return 0}static computeScrollTarget(t,e,r,n){if(!t.length||r<0||r>=t.length)return 0;const s=t.slice();if(n&&"number"==typeof n.activeIndex&&n.activeIndex>=0){const t=n.activeIndex,e=n.activeScale&&isFinite(n.activeScale)&&n.activeScale>0?n.activeScale:1;t>=0&&t<s.length&&1!==e&&(s[t]=(s[t]||0)/e)}let i=0;for(let t=0;t<r;t++)i+=(s[t]||0)+(e||0);return-i-(s[r]||0)/2}static computeTotalScrollableHeight(t,e,r){if(!t.length)return 0;const n=t.slice();if(r&&"number"==typeof r.activeIndex&&r.activeIndex>=0){const t=r.activeIndex,e=r.activeScale&&isFinite(r.activeScale)&&r.activeScale>0?r.activeScale:1;t>=0&&t<n.length&&1!==e&&(n[t]=(n[t]||0)/e)}return n.reduce((t,e)=>t+(e||0),0)+(t.length-1)*(e||0)}static computeScrollClamp(t,e,r=50,n){if(!t.length)return{min:0,max:0};const s=t.slice();if(n&&"number"==typeof n.activeIndex&&n.activeIndex>=0){const t=n.activeIndex,e=n.activeScale&&isFinite(n.activeScale)&&n.activeScale>0?n.activeScale:1;t>=0&&t<s.length&&1!==e&&(s[t]=(s[t]||0)/e)}return{min:-(this.computeTotalScrollableHeight(s,e)-(s[s.length-1]||0)/2)-r,max:-(s[0]||0)/2+r}}static calcScrollPercent(t,e,r,n){if(!e.length||t<0)return"0";const s=e.slice();if(n&&"number"==typeof n.activeIndex&&n.activeIndex>=0){const t=n.activeIndex,e=n.activeScale&&isFinite(n.activeScale)&&n.activeScale>0?n.activeScale:1;t>=0&&t<s.length&&1!==e&&(s[t]=(s[t]||0)/e)}let i=0;for(let e=0;e<t;e++)i+=(s[e]||0)+(r||0);const a=this.computeTotalScrollableHeight(s,r);return(a?i/a*100:0).toFixed(2)}}class i{constructor(){this.state="future",this.progress=0,this.renderProgress=0,this.no=0,this.startTime=0,this.duration=0,this.text="",this.words=[],this.lineNo=0,this.rowTexts=[],this.pseudoPerWord=!1}static get Empty(){const t=new i;return t.duration=1/0,t}hasPerWordTiming(){if(!0===this.pseudoPerWord)return!0;return(this.words||[]).some(t=>(t?.duration||0)>0&&!t.singleLine)}get primaryText(){return this.rowTexts&&this.rowTexts.length>0?this.rowTexts[0]||"":(this.text||"").split("\n")[0]||""}get secondaryText(){if(this.rowTexts&&this.rowTexts.length>1)return this.rowTexts[1]||"";return(this.text||"").split("\n")[1]||""}}const a=/^\[[^:]+:[^\]]*\]/,o=/^(\[(\d+),(\d+)\])/,l=/\[(\d+):(\d+)(?:[.:](\d+))?\]/,h=/\<(\d+)\>/,c=/\<\d+\>/,d=/\[([a-z#]+):([^\]]*)\]/i;class u{static{this.optionLastLyricIsInfinity=!1}static parse(t,e){let r="";r=e instanceof ArrayBuffer?new TextDecoder("utf-8").decode(e):e,r.split(/\r?\n/).forEach(e=>this.#t(t,e)),this.#e(t)}static#t(t,e){o.test(e)&&(e=this.#r(e)),a.test(e)&&(d.test(e)?this.#n(t,e):l.test(e)&&this.#s(t,e))}static#r(t){return t=(t=t.replace(o,(t,e,r)=>{const n=new Date(parseFloat(r));return`[${n.getMinutes()}:${n.getSeconds()}.${n.getMilliseconds()}]`})).replace(/\(0,(\d+)\)/gi,(t,e)=>`<${e}>`)}static#n(t,e){const r=d.exec(e);if(!r)return;const n=r[1].toLowerCase(),s=r[2]||"";switch(n){case"ar":case"au":case"ti":case"al":case"by":case"re":case"ve":case"key":case"sign":case"qq":case"id":case"hash":case"length":t.metadata.set(n,s);break;case"total":{const e=Math.floor(parseInt(s)/1e3+.5),r=String(Math.floor(e/60)).padStart(2,"0"),n=String(e%60).padStart(2,"0");t.metadata.set("length",`${r}:${n}`);break}case"offset":{let e=parseInt(s);isNaN(e)&&(e=0),t.metadata.set("offset",e);break}}}static#s(t,e){const r=[];let s,a=e;for(;s=l.exec(a);){const t=s[3]?parseInt(s[3].padEnd(3,"0")):0,e=1e3*(60*parseInt(s[1])+parseInt(s[2]))+t;r.push(e),a=a.replace(s[0],"")}let o=[];const d=a.split(c);d.shift();let u=0,f=a;for(;s=h.exec(f);){const t=new n;t.lineNo=1,t.duration=parseInt(s[1]),t.text=d[u++]??"",o.push(t),f=f.replace(s[0],"")}if(0===o.length){const t=new n;t.lineNo=1,t.singleLine=!0,t.text=a,o.push(t)}r.forEach(e=>{const r=new i;r.startTime=e,r.text=o.length>0?f:a,r.words=o,t.lines.push(r)})}static#e(t){let e=this.#i(t.lines);e=this.#a(e),this.#o(e),this.#l(e),this.#h(e,t),this.#c(e),t.lines.length=0,t.lines.push(...e)}static#i(t){const e=new Map;for(const r of t){const t=JSON.stringify(r);e.has(t)||e.set(t,r)}return Array.from(e.values())}static#a(t){const e=new Map;for(const r of t){const t=e.get(r.startTime);t?(t.text+="\n"+r.text,r.words.forEach(e=>e.lineNo=(t.words[0]?.lineNo??0)+1),t.words=t.words.concat(r.words)):e.set(r.startTime,r)}return Array.from(e.values())}static#o(t){t.sort((t,e)=>t.startTime-e.startTime)}static#l(t){t.forEach((t,e,r)=>{t.duration=r[e+1]?r[e+1].startTime-t.startTime:t.duration,t.no=e+1,t.rowTexts=t.text.split("\n"),t.rowTexts&&t.rowTexts.length>0&&(t.text=t.rowTexts[0]||"")})}static#h(t,e){if(0!==t.length)if(u.optionLastLyricIsInfinity||!e.metadata.has("length"))t[t.length-1].duration=1/0;else{const r=t[t.length-1],n=l.exec(`[${e.metadata.get("length")}]`);if(n){const t=n[3]?parseInt(n[3].padEnd(3,"0")):0,e=1e3*(60*parseInt(n[1]||"0")+parseInt(n[2]||"0"))+t;r.duration=e-r.startTime,r.duration<=0&&(r.duration=1/0)}else r.duration=1/0}}static#c(t){const e=(t,e)=>{const r=Math.max(1,e),n=Math.floor(t/r),s=new Array(r).fill(n);let i=t-n*r;for(let t=0;t<r&&i>0;t++,i--)s[t]+=1;return s};for(const r of t){const t=(r.words||[]).filter(t=>!t.singleLine&&(t.duration||0)>0),s=Number.isFinite(r.duration)&&(r.duration||0)>0,i=r.rowTexts&&r.rowTexts.length>0?r.rowTexts:r.text?r.text.split("\n"):[""],a=i.reduce((t,e)=>t+(Array.from(e||"").length>0?1:0),0),o=new Map;for(const e of t)o.set(e.lineNo||1,(o.get(e.lineNo||1)||0)+1);const l=Array.from(o.values()).every(t=>t<=1),h=t.length>0&&l&&t.length<=a;if(0!==t.length&&!h)continue;let c=s?Math.round(r.duration):0;if(!c&&t.length>0&&(c=t.reduce((t,e)=>Math.max(t,Math.max(0,Math.round(e.duration||0))),0)),!(c>0))continue;let d=0;if(!i[0]||0===Array.from(i[0]).length){const t=i.findIndex(t=>Array.from(t||"").length>0);d=t>=0?t:0}const u=i[d]||"",f=Array.from(u);if(0===f.length)continue;const g=e(c,f.length),p=[];for(let t=0;t<f.length;t++){const e=new n;e.text=f[t],e.duration=g[t]||0,e.singleLine=!1,e.lineNo=d+1,p.push(e)}p.length>0&&(r.words=p,i&&i.length>0&&(r.text=i[0]||""),r.pseudoPerWord=!0)}}}class f{static generate(t){if(!(t instanceof wn))throw new TypeError("参数 1 必须为 Lyric 实例");const e=[];t.metadata.forEach((t,r)=>{e.push(`[${r}:${t}]`)}),t.lines.forEach(t=>{const r=this.#d(t.startTime),n=t.rowTexts&&t.rowTexts.length>0?t.rowTexts:t.text?t.text.split("\n"):[""];for(let s=0;s<n.length;s++){const i=s+1;let a=n[s]||"";!(!0===t.pseudoPerWord)&&this.#u(t,i)&&(a=this.#f(t,i)),e.push(`${r} ${a}`)}});const r=e.join("\n");return(new TextEncoder).encode(r).buffer}static#d(t){const e=Math.floor(t/1e3),r=Math.floor(e/60),n=e%60,s=t%1e3;return`[${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(s).padStart(3,"0")}]`}static#u(t,e){return!(!t||!Array.isArray(t.words))&&t.words.some(t=>t&&t.lineNo===e&&!t.singleLine&&(t.duration||0)>0)}static#f(t,e){const r=(t.words||[]).filter(t=>t&&t.lineNo===e);if(0===r.length)return"";const n=r.find(t=>t.singleLine);return n?n.text||"":r.map(t=>`<${Math.max(0,Math.round(t.duration||0))}>${t.text||""}`).join("")}}class g{static generate(t){if(!(t instanceof wn))throw new TypeError("参数 1 必须为 Lyric 实例");const e=f.generate(t),r=new TextDecoder("utf-8").decode(e).replace(/<\d+>/g,"");return(new TextEncoder).encode(r).buffer}}class p extends Date{format(t){const e={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(const r in e)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?String(e[r]):("00"+e[r]).substr((""+e[r]).length)));return t}}function _(t){let e=t.length;for(;--e>=0;)t[e]=0}const m=256,w=286,b=30,y=15,x=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),v=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),k=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),T=new Array(576);_(T);const S=new Array(60);_(S);const L=new Array(512);_(L);const E=new Array(256);_(E);const z=new Array(29);_(z);const R=new Array(b);function M(t,e,r,n,s){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=t&&t.length}let F,$,I;function D(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}_(R);const C=t=>t<256?L[t]:L[256+(t>>>7)],N=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},U=(t,e,r)=>{t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,N(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},Z=(t,e,r)=>{U(t,r[2*e],r[2*e+1])},B=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},O=(t,e,r)=>{const n=new Array(16);let s,i,a=0;for(s=1;s<=y;s++)a=a+r[s-1]<<1,n[s]=a;for(i=0;i<=e;i++){let e=t[2*i+1];0!==e&&(t[2*i]=B(n[e]++,e))}},P=t=>{let e;for(e=0;e<w;e++)t.dyn_ltree[2*e]=0;for(e=0;e<b;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},W=t=>{t.bi_valid>8?N(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},j=(t,e,r,n)=>{const s=2*e,i=2*r;return t[s]<t[i]||t[s]===t[i]&&n[e]<=n[r]},H=(t,e,r)=>{const n=t.heap[r];let s=r<<1;for(;s<=t.heap_len&&(s<t.heap_len&&j(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!j(e,n,t.heap[s],t.depth));)t.heap[r]=t.heap[s],r=s,s<<=1;t.heap[r]=n},Y=(t,e,r)=>{let n,s,i,a,o=0;if(0!==t.sym_next)do{n=255&t.pending_buf[t.sym_buf+o++],n+=(255&t.pending_buf[t.sym_buf+o++])<<8,s=t.pending_buf[t.sym_buf+o++],0===n?Z(t,s,e):(i=E[s],Z(t,i+m+1,e),a=x[i],0!==a&&(s-=z[i],U(t,s,a)),n--,i=C(n),Z(t,i,r),a=v[i],0!==a&&(n-=R[i],U(t,n,a)))}while(o<t.sym_next);Z(t,256,e)},q=(t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,i=e.stat_desc.elems;let a,o,l,h=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<i;a++)0!==r[2*a]?(t.heap[++t.heap_len]=h=a,t.depth[a]=0):r[2*a+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,r[2*l]=1,t.depth[l]=0,t.opt_len--,s&&(t.static_len-=n[2*l+1]);for(e.max_code=h,a=t.heap_len>>1;a>=1;a--)H(t,r,a);l=i;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],H(t,r,1),o=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=o,r[2*l]=r[2*a]+r[2*o],t.depth[l]=(t.depth[a]>=t.depth[o]?t.depth[a]:t.depth[o])+1,r[2*a+1]=r[2*o+1]=l,t.heap[1]=l++,H(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const r=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,a=e.stat_desc.extra_bits,o=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,c,d,u,f,g,p=0;for(u=0;u<=y;u++)t.bl_count[u]=0;for(r[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)c=t.heap[h],u=r[2*r[2*c+1]+1]+1,u>l&&(u=l,p++),r[2*c+1]=u,c>n||(t.bl_count[u]++,f=0,c>=o&&(f=a[c-o]),g=r[2*c],t.opt_len+=g*(u+f),i&&(t.static_len+=g*(s[2*c+1]+f)));if(0!==p){do{for(u=l-1;0===t.bl_count[u];)u--;t.bl_count[u]--,t.bl_count[u+1]+=2,t.bl_count[l]--,p-=2}while(p>0);for(u=l;0!==u;u--)for(c=t.bl_count[u];0!==c;)d=t.heap[--h],d>n||(r[2*d+1]!==u&&(t.opt_len+=(u-r[2*d+1])*r[2*d],r[2*d+1]=u),c--)}})(t,e),O(r,h,t.bl_count)},K=(t,e,r)=>{let n,s,i=-1,a=e[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)s=a,a=e[2*(n+1)+1],++o<l&&s===a||(o<h?t.bl_tree[2*s]+=o:0!==s?(s!==i&&t.bl_tree[2*s]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,i=s,0===a?(l=138,h=3):s===a?(l=6,h=3):(l=7,h=4))},V=(t,e,r)=>{let n,s,i=-1,a=e[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),n=0;n<=r;n++)if(s=a,a=e[2*(n+1)+1],!(++o<l&&s===a)){if(o<h)do{Z(t,s,t.bl_tree)}while(0!==--o);else 0!==s?(s!==i&&(Z(t,s,t.bl_tree),o--),Z(t,16,t.bl_tree),U(t,o-3,2)):o<=10?(Z(t,17,t.bl_tree),U(t,o-3,3)):(Z(t,18,t.bl_tree),U(t,o-11,7));o=0,i=s,0===a?(l=138,h=3):s===a?(l=6,h=3):(l=7,h=4)}};let Q=!1;const G=(t,e,r,n)=>{U(t,0+(n?1:0),3),W(t),N(t,r),N(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r};var J=(t,e,r,n)=>{let s,i,a=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<m;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),q(t,t.l_desc),q(t,t.d_desc),a=(t=>{let e;for(K(t,t.dyn_ltree,t.l_desc.max_code),K(t,t.dyn_dtree,t.d_desc.max_code),q(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*A[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),s=t.opt_len+3+7>>>3,i=t.static_len+3+7>>>3,i<=s&&(s=i)):s=i=r+5,r+4<=s&&-1!==e?G(t,e,r,n):4===t.strategy||i===s?(U(t,2+(n?1:0),3),Y(t,T,S)):(U(t,4+(n?1:0),3),((t,e,r,n)=>{let s;for(U(t,e-257,5),U(t,r-1,5),U(t,n-4,4),s=0;s<n;s++)U(t,t.bl_tree[2*A[s]+1],3);V(t,t.dyn_ltree,e-1),V(t,t.dyn_dtree,r-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,a+1),Y(t,t.dyn_ltree,t.dyn_dtree)),P(t),n&&W(t)},X={_tr_init:t=>{Q||((()=>{let t,e,r,n,s;const i=new Array(16);for(r=0,n=0;n<28;n++)for(z[n]=r,t=0;t<1<<x[n];t++)E[r++]=n;for(E[r-1]=n,s=0,n=0;n<16;n++)for(R[n]=s,t=0;t<1<<v[n];t++)L[s++]=n;for(s>>=7;n<b;n++)for(R[n]=s<<7,t=0;t<1<<v[n]-7;t++)L[256+s++]=n;for(e=0;e<=y;e++)i[e]=0;for(t=0;t<=143;)T[2*t+1]=8,t++,i[8]++;for(;t<=255;)T[2*t+1]=9,t++,i[9]++;for(;t<=279;)T[2*t+1]=7,t++,i[7]++;for(;t<=287;)T[2*t+1]=8,t++,i[8]++;for(O(T,287,i),t=0;t<b;t++)S[2*t+1]=5,S[2*t]=B(t,5);F=new M(T,x,257,w,y),$=new M(S,v,0,b,y),I=new M(new Array(0),k,0,19,7)})(),Q=!0),t.l_desc=new D(t.dyn_ltree,F),t.d_desc=new D(t.dyn_dtree,$),t.bl_desc=new D(t.bl_tree,I),t.bi_buf=0,t.bi_valid=0,P(t)},_tr_stored_block:G,_tr_flush_block:J,_tr_tally:(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(E[r]+m+1)]++,t.dyn_dtree[2*C(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{U(t,2,3),Z(t,256,T),(t=>{16===t.bi_valid?(N(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var tt=(t,e,r,n)=>{let s=65535&t,i=t>>>16&65535,a=0;for(;0!==r;){a=r>2e3?2e3:r,r-=a;do{s=s+e[n++]|0,i=i+s|0}while(--a);s%=65521,i%=65521}return s|i<<16};const et=new Uint32Array((()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e})());var rt=(t,e,r,n)=>{const s=et,i=n+r;t^=-1;for(let r=n;r<i;r++)t=t>>>8^s[255&(t^e[r])];return-1^t},nt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},st={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:it,_tr_stored_block:at,_tr_flush_block:ot,_tr_tally:lt,_tr_align:ht}=X,{Z_NO_FLUSH:ct,Z_PARTIAL_FLUSH:dt,Z_FULL_FLUSH:ut,Z_FINISH:ft,Z_BLOCK:gt,Z_OK:pt,Z_STREAM_END:_t,Z_STREAM_ERROR:mt,Z_DATA_ERROR:wt,Z_BUF_ERROR:bt,Z_DEFAULT_COMPRESSION:yt,Z_FILTERED:xt,Z_HUFFMAN_ONLY:vt,Z_RLE:kt,Z_FIXED:At,Z_DEFAULT_STRATEGY:Tt,Z_UNKNOWN:St,Z_DEFLATED:Lt}=st,Et=258,zt=262,Rt=42,Mt=113,Ft=666,$t=(t,e)=>(t.msg=nt[e],e),It=t=>2*t-(t>4?9:0),Dt=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Ct=t=>{let e,r,n,s=t.w_size;e=t.hash_size,n=e;do{r=t.head[--n],t.head[n]=r>=s?r-s:0}while(--e);e=s,n=e;do{r=t.prev[--n],t.prev[n]=r>=s?r-s:0}while(--e)};let Nt=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask;const Ut=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},Zt=(t,e)=>{ot(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Ut(t.strm)},Bt=(t,e)=>{t.pending_buf[t.pending++]=e},Ot=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Pt=(t,e,r,n)=>{let s=t.avail_in;return s>n&&(s=n),0===s?0:(t.avail_in-=s,e.set(t.input.subarray(t.next_in,t.next_in+s),r),1===t.state.wrap?t.adler=tt(t.adler,e,s,r):2===t.state.wrap&&(t.adler=rt(t.adler,e,s,r)),t.next_in+=s,t.total_in+=s,s)},Wt=(t,e)=>{let r,n,s=t.max_chain_length,i=t.strstart,a=t.prev_length,o=t.nice_match;const l=t.strstart>t.w_size-zt?t.strstart-(t.w_size-zt):0,h=t.window,c=t.w_mask,d=t.prev,u=t.strstart+Et;let f=h[i+a-1],g=h[i+a];t.prev_length>=t.good_match&&(s>>=2),o>t.lookahead&&(o=t.lookahead);do{if(r=e,h[r+a]===g&&h[r+a-1]===f&&h[r]===h[i]&&h[++r]===h[i+1]){i+=2,r++;do{}while(h[++i]===h[++r]&&h[++i]===h[++r]&&h[++i]===h[++r]&&h[++i]===h[++r]&&h[++i]===h[++r]&&h[++i]===h[++r]&&h[++i]===h[++r]&&h[++i]===h[++r]&&i<u);if(n=Et-(u-i),i=u-Et,n>a){if(t.match_start=e,a=n,n>=o)break;f=h[i+a-1],g=h[i+a]}}}while((e=d[e&c])>l&&0!==--s);return a<=t.lookahead?a:t.lookahead},jt=t=>{const e=t.w_size;let r,n,s;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-zt)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Ct(t),n+=e),0===t.strm.avail_in)break;if(r=Pt(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=r,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=Nt(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=Nt(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<zt&&0!==t.strm.avail_in)},Ht=(t,e)=>{let r,n,s,i=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,a=0,o=t.strm.avail_in;do{if(r=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s)break;if(s=t.strm.avail_out-s,n=t.strstart-t.block_start,r>n+t.strm.avail_in&&(r=n+t.strm.avail_in),r>s&&(r=s),r<i&&(0===r&&e!==ft||e===ct||r!==n+t.strm.avail_in))break;a=e===ft&&r===n+t.strm.avail_in?1:0,at(t,0,0,a),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,Ut(t.strm),n&&(n>r&&(n=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,r-=n),r&&(Pt(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(0===a);return o-=t.strm.avail_in,o&&(o>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=o&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-o,t.strm.next_in),t.strstart),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),a?4:e!==ct&&e!==ft&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(Pt(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,i=s>t.w_size?t.w_size:s,n=t.strstart-t.block_start,(n>=i||(n||e===ft)&&e!==ct&&0===t.strm.avail_in&&n<=s)&&(r=n>s?s:n,a=e===ft&&0===t.strm.avail_in&&r===n?1:0,at(t,t.block_start,r,a),t.block_start+=r,Ut(t.strm)),a?3:1)},Yt=(t,e)=>{let r,n;for(;;){if(t.lookahead<zt){if(jt(t),t.lookahead<zt&&e===ct)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=Nt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-zt&&(t.match_length=Wt(t,r)),t.match_length>=3)if(n=lt(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Nt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Nt(t,t.ins_h,t.window[t.strstart+1]);else n=lt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===ft?(Zt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zt(t,!1),0===t.strm.avail_out)?1:2},qt=(t,e)=>{let r,n,s;for(;;){if(t.lookahead<zt){if(jt(t),t.lookahead<zt&&e===ct)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=Nt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-zt&&(t.match_length=Wt(t,r),t.match_length<=5&&(t.strategy===xt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-3,n=lt(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=s&&(t.ins_h=Nt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Zt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=lt(t,0,t.window[t.strstart-1]),n&&Zt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=lt(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===ft?(Zt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zt(t,!1),0===t.strm.avail_out)?1:2};function Kt(t,e,r,n,s){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=s}const Vt=[new Kt(0,0,0,0,Ht),new Kt(4,4,8,4,Yt),new Kt(4,5,16,8,Yt),new Kt(4,6,32,32,Yt),new Kt(4,4,16,16,qt),new Kt(8,16,32,32,qt),new Kt(8,16,128,128,qt),new Kt(8,32,128,256,qt),new Kt(32,128,258,1024,qt),new Kt(32,258,258,4096,qt)];function Qt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Lt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Dt(this.dyn_ltree),Dt(this.dyn_dtree),Dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Dt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Gt=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Rt&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==Mt&&e.status!==Ft?1:0},Jt=t=>{if(Gt(t))return $t(t,mt);t.total_in=t.total_out=0,t.data_type=St;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?Rt:Mt,t.adler=2===e.wrap?0:1,e.last_flush=-2,it(e),pt},Xt=t=>{const e=Jt(t);var r;return e===pt&&((r=t.state).window_size=2*r.w_size,Dt(r.head),r.max_lazy_match=Vt[r.level].max_lazy,r.good_match=Vt[r.level].good_length,r.nice_match=Vt[r.level].nice_length,r.max_chain_length=Vt[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),e},te=(t,e,r,n,s,i)=>{if(!t)return mt;let a=1;if(e===yt&&(e=6),n<0?(a=0,n=-n):n>15&&(a=2,n-=16),s<1||s>9||r!==Lt||n<8||n>15||e<0||e>9||i<0||i>At||8===n&&1!==a)return $t(t,mt);8===n&&(n=9);const o=new Qt;return t.state=o,o.strm=t,o.status=Rt,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=s+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<s+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=e,o.strategy=i,o.method=r,Xt(t)};var ee={deflateInit:(t,e)=>te(t,e,Lt,15,8,Tt),deflateInit2:te,deflateReset:Xt,deflateResetKeep:Jt,deflateSetHeader:(t,e)=>Gt(t)||2!==t.state.wrap?mt:(t.state.gzhead=e,pt),deflate:(t,e)=>{if(Gt(t)||e>gt||e<0)return t?$t(t,mt):mt;const r=t.state;if(!t.output||0!==t.avail_in&&!t.input||r.status===Ft&&e!==ft)return $t(t,0===t.avail_out?bt:mt);const n=r.last_flush;if(r.last_flush=e,0!==r.pending){if(Ut(t),0===t.avail_out)return r.last_flush=-1,pt}else if(0===t.avail_in&&It(e)<=It(n)&&e!==ft)return $t(t,bt);if(r.status===Ft&&0!==t.avail_in)return $t(t,bt);if(r.status===Rt&&0===r.wrap&&(r.status=Mt),r.status===Rt){let e=Lt+(r.w_bits-8<<4)<<8,n=-1;if(n=r.strategy>=vt||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=n<<6,0!==r.strstart&&(e|=32),e+=31-e%31,Ot(r,e),0!==r.strstart&&(Ot(r,t.adler>>>16),Ot(r,65535&t.adler)),t.adler=1,r.status=Mt,Ut(t),0!==r.pending)return r.last_flush=-1,pt}if(57===r.status)if(t.adler=0,Bt(r,31),Bt(r,139),Bt(r,8),r.gzhead)Bt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Bt(r,255&r.gzhead.time),Bt(r,r.gzhead.time>>8&255),Bt(r,r.gzhead.time>>16&255),Bt(r,r.gzhead.time>>24&255),Bt(r,9===r.level?2:r.strategy>=vt||r.level<2?4:0),Bt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Bt(r,255&r.gzhead.extra.length),Bt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=rt(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Bt(r,0),Bt(r,0),Bt(r,0),Bt(r,0),Bt(r,0),Bt(r,9===r.level?2:r.strategy>=vt||r.level<2?4:0),Bt(r,3),r.status=Mt,Ut(t),0!==r.pending)return r.last_flush=-1,pt;if(69===r.status){if(r.gzhead.extra){let e=r.pending,n=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+n>r.pending_buf_size;){let s=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>e&&(t.adler=rt(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex+=s,Ut(t),0!==r.pending)return r.last_flush=-1,pt;e=0,n-=s}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending+=n,r.gzhead.hcrc&&r.pending>e&&(t.adler=rt(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let e,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(t.adler=rt(t.adler,r.pending_buf,r.pending-n,n)),Ut(t),0!==r.pending)return r.last_flush=-1,pt;n=0}e=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Bt(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>n&&(t.adler=rt(t.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let e,n=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(t.adler=rt(t.adler,r.pending_buf,r.pending-n,n)),Ut(t),0!==r.pending)return r.last_flush=-1,pt;n=0}e=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Bt(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>n&&(t.adler=rt(t.adler,r.pending_buf,r.pending-n,n))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ut(t),0!==r.pending))return r.last_flush=-1,pt;Bt(r,255&t.adler),Bt(r,t.adler>>8&255),t.adler=0}if(r.status=Mt,Ut(t),0!==r.pending)return r.last_flush=-1,pt}if(0!==t.avail_in||0!==r.lookahead||e!==ct&&r.status!==Ft){let n=0===r.level?Ht(r,e):r.strategy===vt?((t,e)=>{let r;for(;;){if(0===t.lookahead&&(jt(t),0===t.lookahead)){if(e===ct)return 1;break}if(t.match_length=0,r=lt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===ft?(Zt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zt(t,!1),0===t.strm.avail_out)?1:2})(r,e):r.strategy===kt?((t,e)=>{let r,n,s,i;const a=t.window;for(;;){if(t.lookahead<=Et){if(jt(t),t.lookahead<=Et&&e===ct)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(s=t.strstart-1,n=a[s],n===a[++s]&&n===a[++s]&&n===a[++s])){i=t.strstart+Et;do{}while(n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&n===a[++s]&&s<i);t.match_length=Et-(i-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=lt(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=lt(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Zt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===ft?(Zt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zt(t,!1),0===t.strm.avail_out)?1:2})(r,e):Vt[r.level].func(r,e);if(3!==n&&4!==n||(r.status=Ft),1===n||3===n)return 0===t.avail_out&&(r.last_flush=-1),pt;if(2===n&&(e===dt?ht(r):e!==gt&&(at(r,0,0,!1),e===ut&&(Dt(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ut(t),0===t.avail_out))return r.last_flush=-1,pt}return e!==ft?pt:r.wrap<=0?_t:(2===r.wrap?(Bt(r,255&t.adler),Bt(r,t.adler>>8&255),Bt(r,t.adler>>16&255),Bt(r,t.adler>>24&255),Bt(r,255&t.total_in),Bt(r,t.total_in>>8&255),Bt(r,t.total_in>>16&255),Bt(r,t.total_in>>24&255)):(Ot(r,t.adler>>>16),Ot(r,65535&t.adler)),Ut(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?pt:_t)},deflateEnd:t=>{if(Gt(t))return mt;const e=t.state.status;return t.state=null,e===Mt?$t(t,wt):pt},deflateSetDictionary:(t,e)=>{let r=e.length;if(Gt(t))return mt;const n=t.state,s=n.wrap;if(2===s||1===s&&n.status!==Rt||n.lookahead)return mt;if(1===s&&(t.adler=tt(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){0===s&&(Dt(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(r-n.w_size,r),0),e=t,r=n.w_size}const i=t.avail_in,a=t.next_in,o=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,jt(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=Nt(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,jt(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=a,t.input=o,t.avail_in=i,n.wrap=s,pt},deflateInfo:"pako deflate (from Nodeca project)"};const re=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var ne=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const e in r)re(r,e)&&(t[e]=r[e])}}return t},se=t=>{let e=0;for(let r=0,n=t.length;r<n;r++)e+=t[r].length;const r=new Uint8Array(e);for(let e=0,n=0,s=t.length;e<s;e++){let s=t[e];r.set(s,n),n+=s.length}return r};let ie=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){ie=!1}const ae=new Uint8Array(256);for(let t=0;t<256;t++)ae[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ae[254]=ae[254]=1;var oe=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,r,n,s,i,a=t.length,o=0;for(s=0;s<a;s++)r=t.charCodeAt(s),55296==(64512&r)&&s+1<a&&(n=t.charCodeAt(s+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),s++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(o),i=0,s=0;i<o;s++)r=t.charCodeAt(s),55296==(64512&r)&&s+1<a&&(n=t.charCodeAt(s+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[i++]=r:r<2048?(e[i++]=192|r>>>6,e[i++]=128|63&r):r<65536?(e[i++]=224|r>>>12,e[i++]=128|r>>>6&63,e[i++]=128|63&r):(e[i++]=240|r>>>18,e[i++]=128|r>>>12&63,e[i++]=128|r>>>6&63,e[i++]=128|63&r);return e},le=(t,e)=>{const r=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let n,s;const i=new Array(2*r);for(s=0,n=0;n<r;){let e=t[n++];if(e<128){i[s++]=e;continue}let a=ae[e];if(a>4)i[s++]=65533,n+=a-1;else{for(e&=2===a?31:3===a?15:7;a>1&&n<r;)e=e<<6|63&t[n++],a--;a>1?i[s++]=65533:e<65536?i[s++]=e:(e-=65536,i[s++]=55296|e>>10&1023,i[s++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&ie)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r})(i,s)},he=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let r=e-1;for(;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+ae[t[r]]>e?r:e};var ce=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const de=Object.prototype.toString,{Z_NO_FLUSH:ue,Z_SYNC_FLUSH:fe,Z_FULL_FLUSH:ge,Z_FINISH:pe,Z_OK:_e,Z_STREAM_END:me,Z_DEFAULT_COMPRESSION:we,Z_DEFAULT_STRATEGY:be,Z_DEFLATED:ye}=st;function xe(t){this.options=ne({level:we,method:ye,chunkSize:16384,windowBits:15,memLevel:8,strategy:be},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ce,this.strm.avail_out=0;let r=ee.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==_e)throw new Error(nt[r]);if(e.header&&ee.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?oe(e.dictionary):"[object ArrayBuffer]"===de.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=ee.deflateSetDictionary(this.strm,t),r!==_e)throw new Error(nt[r]);this._dict_set=!0}}function ve(t,e){const r=new xe(e);if(r.push(t,!0),r.err)throw r.msg||nt[r.err];return r.result}xe.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let s,i;if(this.ended)return!1;for(i=e===~~e?e:!0===e?pe:ue,"string"==typeof t?r.input=oe(t):"[object ArrayBuffer]"===de.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===fe||i===ge)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(s=ee.deflate(r,i),s===me)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=ee.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===_e;if(0!==r.avail_out){if(i>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},xe.prototype.onData=function(t){this.chunks.push(t)},xe.prototype.onEnd=function(t){t===_e&&(this.result=se(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var ke={Deflate:xe,deflate:ve,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ve(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ve(t,e)},constants:st};const Ae=16209;var Te=function(t,e){let r,n,s,i,a,o,l,h,c,d,u,f,g,p,_,m,w,b,y,x,v,k,A,T;const S=t.state;r=t.next_in,A=t.input,n=r+(t.avail_in-5),s=t.next_out,T=t.output,i=s-(e-t.avail_out),a=s+(t.avail_out-257),o=S.dmax,l=S.wsize,h=S.whave,c=S.wnext,d=S.window,u=S.hold,f=S.bits,g=S.lencode,p=S.distcode,_=(1<<S.lenbits)-1,m=(1<<S.distbits)-1;t:do{f<15&&(u+=A[r++]<<f,f+=8,u+=A[r++]<<f,f+=8),w=g[u&_];e:for(;;){if(b=w>>>24,u>>>=b,f-=b,b=w>>>16&255,0===b)T[s++]=65535&w;else{if(!(16&b)){if(64&b){if(32&b){S.mode=16191;break t}t.msg="invalid literal/length code",S.mode=Ae;break t}w=g[(65535&w)+(u&(1<<b)-1)];continue e}for(y=65535&w,b&=15,b&&(f<b&&(u+=A[r++]<<f,f+=8),y+=u&(1<<b)-1,u>>>=b,f-=b),f<15&&(u+=A[r++]<<f,f+=8,u+=A[r++]<<f,f+=8),w=p[u&m];;){if(b=w>>>24,u>>>=b,f-=b,b=w>>>16&255,16&b){if(x=65535&w,b&=15,f<b&&(u+=A[r++]<<f,f+=8,f<b&&(u+=A[r++]<<f,f+=8)),x+=u&(1<<b)-1,x>o){t.msg="invalid distance too far back",S.mode=Ae;break t}if(u>>>=b,f-=b,b=s-i,x>b){if(b=x-b,b>h&&S.sane){t.msg="invalid distance too far back",S.mode=Ae;break t}if(v=0,k=d,0===c){if(v+=l-b,b<y){y-=b;do{T[s++]=d[v++]}while(--b);v=s-x,k=T}}else if(c<b){if(v+=l+c-b,b-=c,b<y){y-=b;do{T[s++]=d[v++]}while(--b);if(v=0,c<y){b=c,y-=b;do{T[s++]=d[v++]}while(--b);v=s-x,k=T}}}else if(v+=c-b,b<y){y-=b;do{T[s++]=d[v++]}while(--b);v=s-x,k=T}for(;y>2;)T[s++]=k[v++],T[s++]=k[v++],T[s++]=k[v++],y-=3;y&&(T[s++]=k[v++],y>1&&(T[s++]=k[v++]))}else{v=s-x;do{T[s++]=T[v++],T[s++]=T[v++],T[s++]=T[v++],y-=3}while(y>2);y&&(T[s++]=T[v++],y>1&&(T[s++]=T[v++]))}break}if(64&b){t.msg="invalid distance code",S.mode=Ae;break t}w=p[(65535&w)+(u&(1<<b)-1)]}}break}}while(r<n&&s<a);y=f>>3,r-=y,f-=y<<3,u&=(1<<f)-1,t.next_in=r,t.next_out=s,t.avail_in=r<n?n-r+5:5-(r-n),t.avail_out=s<a?a-s+257:257-(s-a),S.hold=u,S.bits=f};const Se=15,Le=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ee=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ze=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Re=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Me=(t,e,r,n,s,i,a,o)=>{const l=o.bits;let h,c,d,u,f,g,p=0,_=0,m=0,w=0,b=0,y=0,x=0,v=0,k=0,A=0,T=null;const S=new Uint16Array(16),L=new Uint16Array(16);let E,z,R,M=null;for(p=0;p<=Se;p++)S[p]=0;for(_=0;_<n;_++)S[e[r+_]]++;for(b=l,w=Se;w>=1&&0===S[w];w--);if(b>w&&(b=w),0===w)return s[i++]=20971520,s[i++]=20971520,o.bits=1,0;for(m=1;m<w&&0===S[m];m++);for(b<m&&(b=m),v=1,p=1;p<=Se;p++)if(v<<=1,v-=S[p],v<0)return-1;if(v>0&&(0===t||1!==w))return-1;for(L[1]=0,p=1;p<Se;p++)L[p+1]=L[p]+S[p];for(_=0;_<n;_++)0!==e[r+_]&&(a[L[e[r+_]]++]=_);if(0===t?(T=M=a,g=20):1===t?(T=Le,M=Ee,g=257):(T=ze,M=Re,g=0),A=0,_=0,p=m,f=i,y=b,x=0,d=-1,k=1<<b,u=k-1,1===t&&k>852||2===t&&k>592)return 1;for(;;){E=p-x,a[_]+1<g?(z=0,R=a[_]):a[_]>=g?(z=M[a[_]-g],R=T[a[_]-g]):(z=96,R=0),h=1<<p-x,c=1<<y,m=c;do{c-=h,s[f+(A>>x)+c]=E<<24|z<<16|R}while(0!==c);for(h=1<<p-1;A&h;)h>>=1;if(0!==h?(A&=h-1,A+=h):A=0,_++,0===--S[p]){if(p===w)break;p=e[r+a[_]]}if(p>b&&(A&u)!==d){for(0===x&&(x=b),f+=m,y=p-x,v=1<<y;y+x<w&&(v-=S[y+x],!(v<=0));)y++,v<<=1;if(k+=1<<y,1===t&&k>852||2===t&&k>592)return 1;d=A&u,s[d]=b<<24|y<<16|f-i}}return 0!==A&&(s[f+A]=p-x<<24|64<<16),o.bits=b,0};const{Z_FINISH:Fe,Z_BLOCK:$e,Z_TREES:Ie,Z_OK:De,Z_STREAM_END:Ce,Z_NEED_DICT:Ne,Z_STREAM_ERROR:Ue,Z_DATA_ERROR:Ze,Z_MEM_ERROR:Be,Z_BUF_ERROR:Oe,Z_DEFLATED:Pe}=st,We=16180,je=16190,He=16191,Ye=16192,qe=16194,Ke=16199,Ve=16200,Qe=16206,Ge=16209,Je=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Xe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tr=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<We||e.mode>16211?1:0},er=t=>{if(tr(t))return Ue;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=We,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,De},rr=t=>{if(tr(t))return Ue;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,er(t)},nr=(t,e)=>{let r;if(tr(t))return Ue;const n=t.state;return e<0?(r=0,e=-e):(r=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Ue:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,rr(t))},sr=(t,e)=>{if(!t)return Ue;const r=new Xe;t.state=r,r.strm=t,r.window=null,r.mode=We;const n=nr(t,e);return n!==De&&(t.state=null),n};let ir,ar,or=!0;const lr=t=>{if(or){ir=new Int32Array(512),ar=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Me(1,t.lens,0,288,ir,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Me(2,t.lens,0,32,ar,0,t.work,{bits:5}),or=!1}t.lencode=ir,t.lenbits=9,t.distcode=ar,t.distbits=5},hr=(t,e,r,n)=>{let s;const i=t.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(e.subarray(r-n,r-n+s),i.wnext),(n-=s)?(i.window.set(e.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0};var cr={inflateReset:rr,inflateReset2:nr,inflateResetKeep:er,inflateInit:t=>sr(t,15),inflateInit2:sr,inflate:(t,e)=>{let r,n,s,i,a,o,l,h,c,d,u,f,g,p,_,m,w,b,y,x,v,k,A=0;const T=new Uint8Array(4);let S,L;const E=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tr(t)||!t.output||!t.input&&0!==t.avail_in)return Ue;r=t.state,r.mode===He&&(r.mode=Ye),a=t.next_out,s=t.output,l=t.avail_out,i=t.next_in,n=t.input,o=t.avail_in,h=r.hold,c=r.bits,d=o,u=l,k=De;t:for(;;)switch(r.mode){case We:if(0===r.wrap){r.mode=Ye;break}for(;c<16;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(2&r.wrap&&35615===h){0===r.wbits&&(r.wbits=15),r.check=0,T[0]=255&h,T[1]=h>>>8&255,r.check=rt(r.check,T,2,0),h=0,c=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=Ge;break}if((15&h)!==Pe){t.msg="unknown compression method",r.mode=Ge;break}if(h>>>=4,c-=4,v=8+(15&h),0===r.wbits&&(r.wbits=v),v>15||v>r.wbits){t.msg="invalid window size",r.mode=Ge;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=512&h?16189:He,h=0,c=0;break;case 16181:for(;c<16;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(r.flags=h,(255&r.flags)!==Pe){t.msg="unknown compression method",r.mode=Ge;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=Ge;break}r.head&&(r.head.text=h>>8&1),512&r.flags&&4&r.wrap&&(T[0]=255&h,T[1]=h>>>8&255,r.check=rt(r.check,T,2,0)),h=0,c=0,r.mode=16182;case 16182:for(;c<32;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}r.head&&(r.head.time=h),512&r.flags&&4&r.wrap&&(T[0]=255&h,T[1]=h>>>8&255,T[2]=h>>>16&255,T[3]=h>>>24&255,r.check=rt(r.check,T,4,0)),h=0,c=0,r.mode=16183;case 16183:for(;c<16;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=255&h,r.head.os=h>>8),512&r.flags&&4&r.wrap&&(T[0]=255&h,T[1]=h>>>8&255,r.check=rt(r.check,T,2,0)),h=0,c=0,r.mode=16184;case 16184:if(1024&r.flags){for(;c<16;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}r.length=h,r.head&&(r.head.extra_len=h),512&r.flags&&4&r.wrap&&(T[0]=255&h,T[1]=h>>>8&255,r.check=rt(r.check,T,2,0)),h=0,c=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(f=r.length,f>o&&(f=o),f&&(r.head&&(v=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+f),v)),512&r.flags&&4&r.wrap&&(r.check=rt(r.check,n,f,i)),o-=f,i+=f,r.length-=f),r.length))break t;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===o)break t;f=0;do{v=n[i+f++],r.head&&v&&r.length<65536&&(r.head.name+=String.fromCharCode(v))}while(v&&f<o);if(512&r.flags&&4&r.wrap&&(r.check=rt(r.check,n,f,i)),o-=f,i+=f,v)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===o)break t;f=0;do{v=n[i+f++],r.head&&v&&r.length<65536&&(r.head.comment+=String.fromCharCode(v))}while(v&&f<o);if(512&r.flags&&4&r.wrap&&(r.check=rt(r.check,n,f,i)),o-=f,i+=f,v)break t}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;c<16;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(4&r.wrap&&h!==(65535&r.check)){t.msg="header crc mismatch",r.mode=Ge;break}h=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=He;break;case 16189:for(;c<32;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}t.adler=r.check=Je(h),h=0,c=0,r.mode=je;case je:if(0===r.havedict)return t.next_out=a,t.avail_out=l,t.next_in=i,t.avail_in=o,r.hold=h,r.bits=c,Ne;t.adler=r.check=1,r.mode=He;case He:if(e===$e||e===Ie)break t;case Ye:if(r.last){h>>>=7&c,c-=7&c,r.mode=Qe;break}for(;c<3;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}switch(r.last=1&h,h>>>=1,c-=1,3&h){case 0:r.mode=16193;break;case 1:if(lr(r),r.mode=Ke,e===Ie){h>>>=2,c-=2;break t}break;case 2:r.mode=16196;break;case 3:t.msg="invalid block type",r.mode=Ge}h>>>=2,c-=2;break;case 16193:for(h>>>=7&c,c-=7&c;c<32;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ge;break}if(r.length=65535&h,h=0,c=0,r.mode=qe,e===Ie)break t;case qe:r.mode=16195;case 16195:if(f=r.length,f){if(f>o&&(f=o),f>l&&(f=l),0===f)break t;s.set(n.subarray(i,i+f),a),o-=f,i+=f,l-=f,a+=f,r.length-=f;break}r.mode=He;break;case 16196:for(;c<14;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(r.nlen=257+(31&h),h>>>=5,c-=5,r.ndist=1+(31&h),h>>>=5,c-=5,r.ncode=4+(15&h),h>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ge;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;c<3;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}r.lens[E[r.have++]]=7&h,h>>>=3,c-=3}for(;r.have<19;)r.lens[E[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},k=Me(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,k){t.msg="invalid code lengths set",r.mode=Ge;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;A=r.lencode[h&(1<<r.lenbits)-1],_=A>>>24,m=A>>>16&255,w=65535&A,!(_<=c);){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(w<16)h>>>=_,c-=_,r.lens[r.have++]=w;else{if(16===w){for(L=_+2;c<L;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(h>>>=_,c-=_,0===r.have){t.msg="invalid bit length repeat",r.mode=Ge;break}v=r.lens[r.have-1],f=3+(3&h),h>>>=2,c-=2}else if(17===w){for(L=_+3;c<L;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}h>>>=_,c-=_,v=0,f=3+(7&h),h>>>=3,c-=3}else{for(L=_+7;c<L;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}h>>>=_,c-=_,v=0,f=11+(127&h),h>>>=7,c-=7}if(r.have+f>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ge;break}for(;f--;)r.lens[r.have++]=v}}if(r.mode===Ge)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=Ge;break}if(r.lenbits=9,S={bits:r.lenbits},k=Me(1,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,k){t.msg="invalid literal/lengths set",r.mode=Ge;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},k=Me(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,k){t.msg="invalid distances set",r.mode=Ge;break}if(r.mode=Ke,e===Ie)break t;case Ke:r.mode=Ve;case Ve:if(o>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=i,t.avail_in=o,r.hold=h,r.bits=c,Te(t,u),a=t.next_out,s=t.output,l=t.avail_out,i=t.next_in,n=t.input,o=t.avail_in,h=r.hold,c=r.bits,r.mode===He&&(r.back=-1);break}for(r.back=0;A=r.lencode[h&(1<<r.lenbits)-1],_=A>>>24,m=A>>>16&255,w=65535&A,!(_<=c);){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(m&&!(240&m)){for(b=_,y=m,x=w;A=r.lencode[x+((h&(1<<b+y)-1)>>b)],_=A>>>24,m=A>>>16&255,w=65535&A,!(b+_<=c);){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}h>>>=b,c-=b,r.back+=b}if(h>>>=_,c-=_,r.back+=_,r.length=w,0===m){r.mode=16205;break}if(32&m){r.back=-1,r.mode=He;break}if(64&m){t.msg="invalid literal/length code",r.mode=Ge;break}r.extra=15&m,r.mode=16201;case 16201:if(r.extra){for(L=r.extra;c<L;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;A=r.distcode[h&(1<<r.distbits)-1],_=A>>>24,m=A>>>16&255,w=65535&A,!(_<=c);){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(!(240&m)){for(b=_,y=m,x=w;A=r.distcode[x+((h&(1<<b+y)-1)>>b)],_=A>>>24,m=A>>>16&255,w=65535&A,!(b+_<=c);){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}h>>>=b,c-=b,r.back+=b}if(h>>>=_,c-=_,r.back+=_,64&m){t.msg="invalid distance code",r.mode=Ge;break}r.offset=w,r.extra=15&m,r.mode=16203;case 16203:if(r.extra){for(L=r.extra;c<L;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ge;break}r.mode=16204;case 16204:if(0===l)break t;if(f=u-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ge;break}f>r.wnext?(f-=r.wnext,g=r.wsize-f):g=r.wnext-f,f>r.length&&(f=r.length),p=r.window}else p=s,g=a-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do{s[a++]=p[g++]}while(--f);0===r.length&&(r.mode=Ve);break;case 16205:if(0===l)break t;s[a++]=r.length,l--,r.mode=Ve;break;case Qe:if(r.wrap){for(;c<32;){if(0===o)break t;o--,h|=n[i++]<<c,c+=8}if(u-=l,t.total_out+=u,r.total+=u,4&r.wrap&&u&&(t.adler=r.check=r.flags?rt(r.check,s,u,a-u):tt(r.check,s,u,a-u)),u=l,4&r.wrap&&(r.flags?h:Je(h))!==r.check){t.msg="incorrect data check",r.mode=Ge;break}h=0,c=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;c<32;){if(0===o)break t;o--,h+=n[i++]<<c,c+=8}if(4&r.wrap&&h!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=Ge;break}h=0,c=0}r.mode=16208;case 16208:k=Ce;break t;case Ge:k=Ze;break t;case 16210:return Be;default:return Ue}return t.next_out=a,t.avail_out=l,t.next_in=i,t.avail_in=o,r.hold=h,r.bits=c,(r.wsize||u!==t.avail_out&&r.mode<Ge&&(r.mode<Qe||e!==Fe))&&hr(t,t.output,t.next_out,u-t.avail_out),d-=t.avail_in,u-=t.avail_out,t.total_in+=d,t.total_out+=u,r.total+=u,4&r.wrap&&u&&(t.adler=r.check=r.flags?rt(r.check,s,u,t.next_out-u):tt(r.check,s,u,t.next_out-u)),t.data_type=r.bits+(r.last?64:0)+(r.mode===He?128:0)+(r.mode===Ke||r.mode===qe?256:0),(0===d&&0===u||e===Fe)&&k===De&&(k=Oe),k},inflateEnd:t=>{if(tr(t))return Ue;let e=t.state;return e.window&&(e.window=null),t.state=null,De},inflateGetHeader:(t,e)=>{if(tr(t))return Ue;const r=t.state;return 2&r.wrap?(r.head=e,e.done=!1,De):Ue},inflateSetDictionary:(t,e)=>{const r=e.length;let n,s,i;return tr(t)?Ue:(n=t.state,0!==n.wrap&&n.mode!==je?Ue:n.mode===je&&(s=1,s=tt(s,e,r,0),s!==n.check)?Ze:(i=hr(t,e,r,r),i?(n.mode=16210,Be):(n.havedict=1,De)))},inflateInfo:"pako inflate (from Nodeca project)"};var dr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ur=Object.prototype.toString,{Z_NO_FLUSH:fr,Z_FINISH:gr,Z_OK:pr,Z_STREAM_END:_r,Z_NEED_DICT:mr,Z_STREAM_ERROR:wr,Z_DATA_ERROR:br,Z_MEM_ERROR:yr}=st;function xr(t){this.options=ne({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(15&e.windowBits||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ce,this.strm.avail_out=0;let r=cr.inflateInit2(this.strm,e.windowBits);if(r!==pr)throw new Error(nt[r]);if(this.header=new dr,cr.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=oe(e.dictionary):"[object ArrayBuffer]"===ur.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=cr.inflateSetDictionary(this.strm,e.dictionary),r!==pr)))throw new Error(nt[r])}function vr(t,e){const r=new xr(e);if(r.push(t),r.err)throw r.msg||nt[r.err];return r.result}xr.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,a,o;if(this.ended)return!1;for(a=e===~~e?e:!0===e?gr:fr,"[object ArrayBuffer]"===ur.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=cr.inflate(r,a),i===mr&&s&&(i=cr.inflateSetDictionary(r,s),i===pr?i=cr.inflate(r,a):i===br&&(i=mr));r.avail_in>0&&i===_r&&r.state.wrap>0&&0!==t[r.next_in];)cr.inflateReset(r),i=cr.inflate(r,a);switch(i){case wr:case br:case mr:case yr:return this.onEnd(i),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(0===r.avail_out||i===_r))if("string"===this.options.to){let t=he(r.output,r.next_out),e=r.next_out-t,s=le(r.output,t);r.next_out=e,r.avail_out=n-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(s)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(i!==pr||0!==o){if(i===_r)return i=cr.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},xr.prototype.onData=function(t){this.chunks.push(t)},xr.prototype.onEnd=function(t){t===pr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=se(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var kr={Inflate:xr,inflate:vr,inflateRaw:function(t,e){return(e=e||{}).raw=!0,vr(t,e)},ungzip:vr,constants:st};const{Deflate:Ar,deflate:Tr,deflateRaw:Sr,gzip:Lr}=ke,{Inflate:Er,inflate:zr,inflateRaw:Rr,ungzip:Mr}=kr;var Fr=Tr,$r=zr,Ir=Rr;const Dr="krc1",Cr=[64,71,97,119,94,50,116,71,81,54,49,45,206,210,110,105];function Nr(t,e=Cr){const r=new Uint8Array(t.length),n=e.length;for(let s=0;s<t.length;s++)r[s]=t[s]^255&e[s%n];return r}const Ur=/\[([a-z#]+):([^\]]*)\]/i,Zr=/\[(\d+),(\d+)\]/,Br=/<(\d+),(\d+),0>([^<]+)/;class Or{static parse(t,e){const r=this.#g(new Uint8Array(e));let n={lrc:""};r.split(/\r?\n/).forEach(e=>this.#t(t,e,n)),u.parse(t,n.lrc)}static#g(t){if(t.byteLength<4)throw new RangeError;const e=(new TextDecoder).decode(t.slice(0,4));if(Dr!==e)throw new TypeError;const r=Nr(t.slice(4),Cr),n=$r(r,{to:"string"});return 65279===(s=n).charCodeAt(0)?s.slice(1):s;var s}static#t(t,e,r){Ur.test(e)?this.#p(t,e,r):Zr.test(e)&&this.#s(t,e,r)}static#p(t,e,r){const n=Ur.exec(e);if(!n)return;if("language"===n[1].toLowerCase())try{const e=function(t){const e=globalThis;return"function"==typeof e?.atob?e.atob(t):"undefined"!=typeof Buffer?Buffer.from(t,"base64").toString("utf-8"):t}(n[2]);t.metadata.set("language",JSON.parse(e))}catch{}else r.lrc+=e+"\n"}static#s(t,e,r){let n,s="",i=e;for(;n=Zr.exec(i);)s+=`[${new p(parseInt(n[1])).format("mm:ss:S")}]`,i=i.replace(n[0],"");for(;n=Br.exec(i);)s+=`<${n[2]}>${n[3]}`,i=i.replace(n[0],"");r.lrc+=s+"\n"}}class Pr{static generate(t){if(!(t instanceof wn))throw new TypeError("参数 1 必须为 Lyric 实例");const e=[];t.metadata.forEach((t,r)=>{if("language"===r.toLowerCase())try{let r=t;if("string"==typeof t)try{r=JSON.parse(t)}catch{r=t}const n=function(t){const e=globalThis;return"function"==typeof e?.btoa?e.btoa(t):"undefined"!=typeof Buffer?Buffer.from(t,"utf-8").toString("base64"):t}(JSON.stringify(r));e.push(`[language:${n}]`)}catch{e.push(`[language:${String(t)}]`)}else e.push(`[${r}:${String(t)}]`)});for(const r of t.lines){const t=!0===r.pseudoPerWord,n=Math.max(0,Math.round(r.startTime||0));let s=Math.round(r.duration||0);(!Number.isFinite(s)||s<0)&&(s=0);const i=r.rowTexts&&r.rowTexts.length>0?r.rowTexts:r.text?r.text.split("\n"):[""],a=t=>(t||"").replace(/[\s\u200b]+/g,""),o=i.map(t=>a(t)),l=(r.words||[]).filter(t=>!t.singleLine),h=a(l.map(t=>t.text||"").join(""));let c=-1;h&&(c=o.findIndex(t=>t===h));for(let h=0;h<i.length;h++){const d=h+1;let u=t?[]:(r.words||[]).filter(t=>!t.singleLine&&(t?.lineNo||0)===d),f=i[h]||"";f.includes("\n")&&(f=f.split("\n")[0]||"");const g=a(f);for(let t=0;t<i.length;t++){if(t===h)continue;const e=i[t]||"",r=a(e);if(r&&g.endsWith(r)){const t=g.lastIndexOf(r);f=f.slice(0,Math.max(0,f.length-(g.length-t)));break}}if(u.length>0){const t=a(u.map(t=>t.text||"").join(""));if(!(t&&t===o[h])&&t&&o.length>1){-1!==o.findIndex((e,r)=>r!==h&&e===t)&&(u=[])}}if(0===u.length&&c===h&&l.length>0&&(u=l),!t&&u.length>0){let t=0;const e=[],r=a(f);let n="";for(const s of u){const i=Math.max(0,Math.round(s.duration||0)),o=s.text&&s.text.length>0?s.text:"​",l=n+a(o);if(r&&l.length>r.length)break;if(r&&!r.startsWith(l))break;if(e.push(`<${t},${i},0>${o}`),t+=i,n=l,r&&n.length===r.length)break}f=e.length>0?e.join(""):`<0,${s},0>${f&&f.length>0?f:"​"}`}else{f=`<0,${s},0>${f&&f.length>0?f:"​"}`}e.push(`[${n},${s}]${f}`)}}const r=e.join("\n"),n=Nr(Fr(r),Cr),s=(new TextEncoder).encode(Dr),i=new Uint8Array(s.length+n.length);return i.set(s,0),i.set(n,s.length),i.buffer}}function Wr(t){const e=(t||"").trim(),r=/^(\d{1,2}):(\d{1,2})(?:[.:](\d{1,3}))?$/.exec(e);if(!r)return NaN;return 6e4*(parseInt(r[1],10)||0)+1e3*(parseInt(r[2],10)||0)+(r[3]?parseInt(r[3].padEnd(3,"0"),10):0)}function jr(t){return(t||"").split(/\s*,\s*/).filter(Boolean).map(t=>{const e=parseInt(t,10);return Number.isFinite(e)&&e>0?e:0})}function Hr(t){return Array.from(t||"")}class Yr{static parse(t,e){let r="";if(e instanceof ArrayBuffer){const t=e,n=(e,r=!1)=>{try{return new TextDecoder(e,{fatal:r}).decode(t)}catch{return null}};let s=n("utf-8",!0);if(null==s)s=n("gb18030")||n("gbk")||n("gb2312")||n("utf-8",!1);else{const t=(s.match(/\uFFFD/g)||[]).length;if(t>0){const e=n("gb18030");e&&(e.match(/\uFFFD/g)||[]).length<t&&(s=e)}}r=s??""}else r=e;if(r=function(t){return t&&65279===t.charCodeAt(0)?t.slice(1):t}(r||""),!/karaoke\s*\./i.test(r))throw new TypeError("非 KSC 内容");const n=r.split(/\r?\n/).map(t=>t.replace(/\/\/.*$/,"").trim()).filter(t=>t.length>0),s=/^karaoke\.tag\(\s*'([^']*)'\s*,\s*'([^']*)'\s*\)\s*;?$/i,i=/^karaoke\.rows\s*:=\s*(\d+)\s*;?$/i,a=/^karaoke\.(videofilename|audiofilename)\s*:=\s*'([^']*)'\s*;?$/i,o=/^karaoke\.(internalnumber)\s*:=\s*(\d+)\s*;?$/i,l=/^karaoke\.add\(\s*'([^']+)'\s*,\s*'([^']+)'\s*,\s*'([^']*)'\s*,\s*'([^']*)'\s*\)\s*;?$/i;let h,c="";for(const e of n){let r;if(r=s.exec(e)){const e=(r[1]||"").trim(),n=(r[2]||"").trim();"歌名"===e?t.metadata.set("ti",n):"歌手"===e&&t.metadata.set("ar",n),t.metadata.set(e,n),"歌名"===e&&(c+=`[ti:${n}]\n`),"歌手"===e&&(c+=`[ar:${n}]\n`);continue}if(r=i.exec(e))h=parseInt(r[1],10),Number.isFinite(h)&&t.metadata.set("rows",h);else{if(r=a.exec(e)){const e=r[1].toLowerCase(),n=r[2];t.metadata.set(e,n);continue}if(r=o.exec(e)){const e=r[1].toLowerCase(),n=parseInt(r[2],10);t.metadata.set(e,Number.isFinite(n)?n:r[2]);continue}if(r=l.exec(e)){const t=Wr(r[1]),e=Wr(r[2]);if(!Number.isFinite(t)||!Number.isFinite(e)||e<t)continue;const n=r[3]||"",s=jr(r[4]||""),i=Hr(n),a=(()=>{const e=Math.floor(t/1e3),r=Math.floor(e/60),n=e%60,s=t%1e3;return`[${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(s).padStart(3,"0")}]`})();let o="";if(s.length===i.length&&i.length>0)for(let t=0;t<i.length;t++){o+=`<${Math.max(0,Math.round(s[t]||0))}>${i[t]}`}else{o=`<${Math.max(0,Math.round(e-t))}>${n&&n.length>0?n:"​"}`}c+=`${a}${o}\n`;continue}}}u.parse(t,c)}}class qr{static generate(t){if(!(t instanceof wn))throw new TypeError("参数 1 必须为 Lyric 实例");const e=t=>{const e=Math.max(0,Math.floor(t)),r=Math.floor(e/6e4),n=Math.floor(e%6e4/1e3),s=e%1e3;return`${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}.${String(s).padStart(3,"0")}`},r=t=>(t||"").replace(/\\/g,"\\\\").replace(/'/g,"\\'"),n=t=>(t||"").replace(/[\s\u200b]+/g,""),s=[];s.push("karaoke := CreateKaraokeObject;");let i=1;for(const e of t.lines){const t=e.rowTexts&&e.rowTexts.length>0?e.rowTexts:e.text?e.text.split("\n"):[""];t.length>i&&(i=t.length)}s.push(`karaoke.rows := ${Math.max(1,Math.min(i,4))};`),s.push("karaoke.clear;");const a=t.metadata,o=new Set,l=(t,e)=>{s.push(`karaoke.tag('${r(t)}', '${r(e)}');`),o.add(t)},h=(t,e)=>s.push(`karaoke.${t} := '${r(e)}';`),c=a.get("ti");"string"==typeof c&&c&&l("歌名",String(c));const d=a.get("ar");"string"==typeof d&&d&&l("歌手",String(d));const u=a.get("videofilename");"string"==typeof u&&u&&h("videofilename",u);const f=a.get("audiofilename");"string"==typeof f&&f&&h("audiofilename",f);const g=a.get("internalnumber");var p,_;"number"==typeof g&&(p="internalnumber",_=g,s.push(`karaoke.${p} := ${Math.trunc(_)};`)),a.forEach((t,e)=>{"ti"!==e&&"ar"!==e&&"rows"!==e&&"videofilename"!==e&&"audiofilename"!==e&&"internalnumber"!==e&&(o.has(e)||"string"!=typeof t&&"number"!=typeof t||l(e,String(t)))});for(const i of t.lines){const t=!0===i.pseudoPerWord,a=Math.max(0,Math.round(i.startTime||0));let o=Math.round(i.duration||0);(!Number.isFinite(o)||o<0)&&(o=0);const l=a+o,h=(i.words||[]).filter(t=>!t.singleLine),c=n(h.map(t=>t.text||"").join("")),d=i.rowTexts&&i.rowTexts.length>0?i.rowTexts:i.text?i.text.split("\n"):[""];for(let u=0;u<d.length;u++){const f=u+1;let g=d[u]||"";if(!g||!g.trim())continue;let p=t?[]:(i.words||[]).filter(t=>!t.singleLine&&(t?.lineNo||0)===f);const _=n(g);if(p.length>0){const t=n(p.map(t=>t.text||"").join(""));if(t&&_&&t!==_){-1!==d.findIndex((e,r)=>r!==u&&n(e)===t)&&(p=[])}}0===p.length&&h.length>0&&c&&c===_&&(p=h);const m=Array.from(g);let w="";const b=(t,e)=>{const r=Math.max(1,e),n=Math.floor(t/r),s=new Array(r).fill(n);let i=t-n*r;for(let t=0;t<r&&i>0;t++,i--)s[t]+=1;return s};if(!t&&p.length>0){if(p.map(t=>t.text||"").join("")===g){const t=[];for(const e of p){const r=Math.max(0,Math.round(e.duration||0)),n=Array.from(e.text||"");if(n.length<=0)continue;const s=Math.floor(r/n.length);let i=r-s*n.length;for(let e=0;e<n.length;e++){const e=s+(i>0?1:0);i>0&&i--,t.push(e)}}if(t.length!==m.length){w=b(p.reduce((t,e)=>t+Math.max(0,Math.round(e.duration||0)),0)||o,m.length).join(",")}else w=t.join(",")}else{w=b(p.reduce((t,e)=>t+Math.max(0,Math.round(e.duration||0)),0)||o,m.length).join(",")}}else w=String(o);s.push(`karaoke.add('${e(a)}', '${e(l)}', '${r(g)}', '${w}');`)}}const m=s.join("\n");return(new TextEncoder).encode(m).buffer}}const Kr=[[14,4,13,1,2,15,11,8,3,10,6,12,5,9,0,7,0,15,7,4,14,2,13,1,10,6,12,11,9,5,3,8,4,1,14,8,13,6,2,11,15,12,9,7,3,10,5,0,15,12,8,2,4,9,1,7,5,11,3,14,10,0,6,13],[15,1,8,14,6,11,3,4,9,7,2,13,12,0,5,10,3,13,4,7,15,2,8,15,12,0,1,10,6,9,11,5,0,14,7,11,10,4,13,1,5,8,12,6,9,3,2,15,13,8,10,1,3,15,4,2,11,6,7,12,0,5,14,9],[10,0,9,14,6,3,15,5,1,13,12,7,11,4,2,8,13,7,0,9,3,4,6,10,2,8,5,14,12,11,15,1,13,6,4,9,8,15,3,0,11,1,2,12,5,10,14,7,1,10,13,0,6,9,8,7,4,15,14,3,11,5,2,12],[7,13,14,3,0,6,9,10,1,2,8,5,11,12,4,15,13,8,11,5,6,15,0,3,4,7,2,12,1,10,14,9,10,6,9,0,12,11,7,13,15,1,3,14,5,2,8,4,3,15,0,6,10,10,13,8,9,4,5,11,12,7,2,14],[2,12,4,1,7,10,11,6,8,5,3,15,13,0,14,9,14,11,2,12,4,7,13,1,5,0,15,10,3,9,8,6,4,2,1,11,10,13,7,8,15,9,12,5,6,3,0,14,11,8,12,7,1,14,2,13,6,15,0,9,10,4,5,3],[12,1,10,15,9,2,6,8,0,13,3,4,14,7,5,11,10,15,4,2,7,12,9,5,6,1,13,14,0,11,3,8,9,14,15,5,2,8,12,3,7,0,4,10,1,13,11,6,4,3,2,12,9,5,15,10,11,14,1,7,6,0,8,13],[4,11,2,14,15,0,8,13,3,12,9,7,5,10,6,1,13,0,11,7,4,9,1,10,14,3,5,12,2,15,8,6,1,4,11,13,12,3,7,14,10,15,6,8,0,5,9,2,6,11,13,8,1,4,10,7,9,5,0,15,14,2,3,12],[13,2,8,4,6,15,11,1,10,9,3,14,5,0,12,7,1,15,13,8,10,3,7,4,12,5,6,11,0,14,9,2,7,11,4,1,9,12,14,2,0,6,10,13,15,3,5,8,2,1,14,7,4,10,8,13,15,12,9,0,3,5,6,11]];function Vr(t,e,r){const n=7-e%8;return(t[4*Math.floor(e/32)+3-Math.floor(e%32/8)]>>n&1)<<r>>>0}function Qr(t,e,r){return(t>>31-e&1)<<r>>>0}function Gr(t,e,r){return(t<<e&2147483648)>>>r>>>0}function Jr(t){return 32&t|(31&t)>>1|(1&t)<<4}function Xr(t,e){const r=Gr(t,31,0)|(4026531840&t)>>>1|Gr(t,4,5)|Gr(t,3,6)|(251658240&t)>>>3|Gr(t,8,11)|Gr(t,7,12)|(15728640&t)>>>5|Gr(t,12,17)|Gr(t,11,18)|(983040&t)>>>7|Gr(t,16,23),n=Gr(t,15,0)|(61440&t)<<15|Gr(t,20,5)|Gr(t,19,6)|(3840&t)<<13|Gr(t,24,11)|Gr(t,23,12)|(240&t)<<11|Gr(t,28,17)|Gr(t,27,18)|(15&t)<<9|Gr(t,0,23),s=new Uint8Array(6);s[0]=r>>>24&255,s[1]=r>>>16&255,s[2]=r>>>8&255,s[3]=n>>>24&255,s[4]=n>>>16&255,s[5]=n>>>8&255;for(let t=0;t<6;t++)s[t]^=e[t];const i=new Uint8Array(8);i[0]=s[0]>>2,i[1]=(3&s[0])<<4|s[1]>>4,i[2]=(15&s[1])<<2|s[2]>>6,i[3]=63&s[2],i[4]=s[3]>>2,i[5]=(3&s[3])<<4|s[4]>>4,i[6]=(15&s[4])<<2|s[5]>>6,i[7]=63&s[5];let a=0;for(let t=0;t<8;t++)a|=(15&Kr[t][Jr(i[t])])<<4*(7-t);return(Gr(a,15,0)|Gr(a,6,1)|Gr(a,19,2)|Gr(a,20,3)|Gr(a,28,4)|Gr(a,11,5)|Gr(a,27,6)|Gr(a,16,7)|Gr(a,0,8)|Gr(a,14,9)|Gr(a,22,10)|Gr(a,25,11)|Gr(a,4,12)|Gr(a,17,13)|Gr(a,30,14)|Gr(a,9,15)|Gr(a,1,16)|Gr(a,7,17)|Gr(a,23,18)|Gr(a,13,19)|Gr(a,31,20)|Gr(a,26,21)|Gr(a,2,22)|Gr(a,8,23)|Gr(a,18,24)|Gr(a,12,25)|Gr(a,29,26)|Gr(a,5,27)|Gr(a,21,28)|Gr(a,10,29)|Gr(a,3,30)|Gr(a,24,31))>>>0}function tn(t,e,r){const n=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1],s=[56,48,40,32,24,16,8,0,57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35],i=[62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,60,52,44,36,28,20,12,4,27,19,11,3],a=[13,16,10,23,0,4,2,27,14,5,20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31];let o=0,l=0,h=31;for(let e=0;e<28;e++)o|=Vr(t,s[e],h),h--;h=31;for(let e=0;e<28;e++)l|=Vr(t,i[e],h),h--;for(let t=0;t<16;t++){const s=n[t];o=4294967280&(o<<s|o>>>28-s),l=4294967280&(l<<s|l>>>28-s);const i=e[0===r?15-t:t];i.fill(0);for(let t=0;t<24;t++)i[t>>3]|=Qr(o,a[t],7-t%8);for(let t=24;t<48;t++)i[t>>3]|=Qr(l,a[t]-27,7-t%8)}}function en(t,e){const r=new Int32Array(2);!function(t,e){t[0]=Vr(e,57,31)|Vr(e,49,30)|Vr(e,41,29)|Vr(e,33,28)|Vr(e,25,27)|Vr(e,17,26)|Vr(e,9,25)|Vr(e,1,24)|Vr(e,59,23)|Vr(e,51,22)|Vr(e,43,21)|Vr(e,35,20)|Vr(e,27,19)|Vr(e,19,18)|Vr(e,11,17)|Vr(e,3,16)|Vr(e,61,15)|Vr(e,53,14)|Vr(e,45,13)|Vr(e,37,12)|Vr(e,29,11)|Vr(e,21,10)|Vr(e,13,9)|Vr(e,5,8)|Vr(e,63,7)|Vr(e,55,6)|Vr(e,47,5)|Vr(e,39,4)|Vr(e,31,3)|Vr(e,23,2)|Vr(e,15,1)|Vr(e,7,0)|0,t[1]=Vr(e,56,31)|Vr(e,48,30)|Vr(e,40,29)|Vr(e,32,28)|Vr(e,24,27)|Vr(e,16,26)|Vr(e,8,25)|Vr(e,0,24)|Vr(e,58,23)|Vr(e,50,22)|Vr(e,42,21)|Vr(e,34,20)|Vr(e,26,19)|Vr(e,18,18)|Vr(e,10,17)|Vr(e,2,16)|Vr(e,60,15)|Vr(e,52,14)|Vr(e,44,13)|Vr(e,36,12)|Vr(e,28,11)|Vr(e,20,10)|Vr(e,12,9)|Vr(e,4,8)|Vr(e,62,7)|Vr(e,54,6)|Vr(e,46,5)|Vr(e,38,4)|Vr(e,30,3)|Vr(e,22,2)|Vr(e,14,1)|Vr(e,6,0)|0}(r,t);for(let t=0;t<15;t++){const n=r[1];r[1]=Xr(r[1],e[t])^r[0]|0,r[0]=0|n}r[0]=Xr(r[1],e[15])^r[0]|0;const n=new Uint8Array(8);return function(t,e){e[3]=255&(Qr(t[1],7,7)|Qr(t[0],7,6)|Qr(t[1],15,5)|Qr(t[0],15,4)|Qr(t[1],23,3)|Qr(t[0],23,2)|Qr(t[1],31,1)|Qr(t[0],31,0)),e[2]=255&(Qr(t[1],6,7)|Qr(t[0],6,6)|Qr(t[1],14,5)|Qr(t[0],14,4)|Qr(t[1],22,3)|Qr(t[0],22,2)|Qr(t[1],30,1)|Qr(t[0],30,0)),e[1]=255&(Qr(t[1],5,7)|Qr(t[0],5,6)|Qr(t[1],13,5)|Qr(t[0],13,4)|Qr(t[1],21,3)|Qr(t[0],21,2)|Qr(t[1],29,1)|Qr(t[0],29,0)),e[0]=255&(Qr(t[1],4,7)|Qr(t[0],4,6)|Qr(t[1],12,5)|Qr(t[0],12,4)|Qr(t[1],20,3)|Qr(t[0],20,2)|Qr(t[1],28,1)|Qr(t[0],28,0)),e[7]=255&(Qr(t[1],3,7)|Qr(t[0],3,6)|Qr(t[1],11,5)|Qr(t[0],11,4)|Qr(t[1],19,3)|Qr(t[0],19,2)|Qr(t[1],27,1)|Qr(t[0],27,0)),e[6]=255&(Qr(t[1],2,7)|Qr(t[0],2,6)|Qr(t[1],10,5)|Qr(t[0],10,4)|Qr(t[1],18,3)|Qr(t[0],18,2)|Qr(t[1],26,1)|Qr(t[0],26,0)),e[5]=255&(Qr(t[1],1,7)|Qr(t[0],1,6)|Qr(t[1],9,5)|Qr(t[0],9,4)|Qr(t[1],17,3)|Qr(t[0],17,2)|Qr(t[1],25,1)|Qr(t[0],25,0)),e[4]=255&(Qr(t[1],0,7)|Qr(t[0],0,6)|Qr(t[1],8,5)|Qr(t[0],8,4)|Qr(t[1],16,3)|Qr(t[0],16,2)|Qr(t[1],24,1)|Qr(t[0],24,0))}(r,n),n}function rn(t,e,r){const n=Array.from({length:16},()=>new Uint8Array(6));tn(e,n,r);const s=new Uint8Array(t.length);for(let e=0;e<t.length;e+=8){const r=t.subarray(e,Math.min(e+8,t.length));const i=en(8===r.length?r:(()=>{const t=new Uint8Array(8);return t.set(r),t})(),n);s.set(i.subarray(0,r.length),e)}return s}const nn="9825B0ACE3028368E8FC6C";let sn="629F5B0900C35E95239F13117ED8923FBC90BB740EC347743D90AA3F51D8F411849FDE951DC3C609D59FFA66F9D8F0F7A090A1D6F3C3F3D6A190A0F7F0D8F966FA9FD509C6C31D95DE9F8411F4D8513FAA903D7447C30E74BB90BC3F92D87E11139F23955EC300095B9F6266A1D852F76790CAD64AC34AD6CA9067F752D8A166";const an="!@#)(NHLiuy*$%^&",on="123ZXC!@#)(*$%^&",ln="!@#)(*$%^&abcDEF";function hn(t){const e=t.replace(/\s+/g,"").toLowerCase();if(e.length%2!=0)throw new Error("非法 hex 长度");const r=new Uint8Array(e.length/2);for(let t=0;t<r.length;t++)r[t]=parseInt(e.substr(2*t,2),16);return r}function cn(t){let e="";for(let r=0;r<t.length;r++){e+=t[r].toString(16).padStart(2,"0")}return e.toUpperCase()}function dn(t,e){let r=t.replace(/\s+/g,""),n=e.replace(/\s+/g,"");r.length%2!=0&&(r="0"+r),n.length%2!=0&&(n="0"+n);const s=hn(r),i=hn(n),a=new Uint8Array(s.length);for(let t=0;t<s.length;t++)a[t]=s[t]^i[t%i.length];return cn(a)}function un(t){return t.replace(/<[^>]+>/g,"")}function fn(t){return t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'")}function gn(t){return/^[\s()]*$/.test(t)}function pn(t){const e=Math.floor(t/6e4),r=Math.floor(t%6e4/1e3),n=Math.floor(t%1e3);return`[${String(e).padStart(2,"0")}:${String(r).padStart(2,"0")}.${String(n).padStart(3,"0")}]`}class _n{static setXorKeyHex(t){sn=(t||"").replace(/\s+/g,"")}static parse(t,e){const r=new Uint8Array(e);let n=0;const s=Math.min(16,r.length);for(let t=0;t<s;t++){const e=r[t];(9===e||10===e||13===e||e>=32&&e<=126)&&n++}if(n>.8*s)throw new TypeError("非 QRC 二进制");let i=cn(r);i.startsWith(nn)&&(i=i.slice(22));const a=function(t){const e=(new TextEncoder).encode(an).slice(0,8),r=(new TextEncoder).encode(on).slice(0,8),n=(new TextEncoder).encode(ln).slice(0,8);let s=rn(t,e,0),i=rn(s,r,1);return rn(i,n,0)}(hn(dn(i,sn)));let o="";try{o=$r(a,{to:"string"})}catch(t){try{o=Ir(a,{to:"string"})}catch{throw t}}var l;if(o=(l=o||"")&&65279===l.charCodeAt(0)?l.slice(1):l,!o||!/<QrcInfos[>\s]/i.test(o))throw new SyntaxError("QRC 解密失败或内容无效");const h=function(t){const e=/<Lyric_\d+\b[^>]*?LyricContent="([\s\S]*?)"/i.exec(t);if(e&&e[1]){const t=[],r=fn(e[1]).split(/\r?\n/);for(const e of r){const r=e;if(/^\s*\[(ti|ar|al|by|offset):[^\]]*\]\s*$/i.test(r)){t.push(r.trim());continue}const n=/^\s*\[(\d+)\s*,\s*(\d+)\]\s*(.*)$/.exec(r);if(n){const e=parseInt(n[1],10),r=n[3]||"",s=pn(isFinite(e)?e:0),i=[],a=/\((\d+)\s*,\s*(\d+)\)/g;let o,l=0;for(;o=a.exec(r);){const t=r.slice(l,o.index),e=parseInt(o[2],10),n=isFinite(e)?Math.max(0,e):0,s=fn(t);gn(s)||i.push(`<${n}>${s.length?s:"​"}`),l=a.lastIndex}const h=fn(r.slice(l));t.push(s+i.join("")+(h&&!gn(h)?h:""));continue}r.trim()&&t.push(r)}return t.join("\n")}const r=[],n=/<([a-zA-Z_][\w\-]*)\b[^>]*?BeginTime="(\d+)"[^>]*?Duration="(\d+)"[^>]*>([\s\S]*?)<\/\1>/g;let s;for(;s=n.exec(t);){const t=parseInt(s[2]),e=s[4]||"",n=[],i=/<([a-zA-Z_][\w\-]*)\b[^>]*?(?:Duration|Len|Length)="(\d+)"[^>]*>([\s\S]*?)<\/\1>/g;let a;for(;a=i.exec(e);){const t=parseInt(a[2]),e=fn(un(a[3]||"").trim());n.push({d:isFinite(t)?t:0,t:e})}const o=fn(un(e).trim()),l=pn(t);if(n.length>0){const t=n.map(t=>`<${Math.max(0,t.d)}>​${t.t}`);r.push(`${l}${t.join("")}`)}else r.push(`${l}${o}`)}return r.join("\n")}(o);if(!h.trim())throw new SyntaxError("QRC 转换为空");u.parse(t,h)}}class mn{static generate(t){if(!(t instanceof wn))throw new TypeError("参数 1 必须为 Lyric 实例");const e=[],r=t=>(t||"").replace(/[\s\u200b]+/g,"");for(const n of t.lines){const t=!0===n.pseudoPerWord,s=Math.max(0,Math.round(n.startTime||0));let i=Math.round(n.duration||0);(!Number.isFinite(i)||i<0)&&(i=0);const a=n.rowTexts&&n.rowTexts.length>0?n.rowTexts:n.text?n.text.split("\n"):[""],o=(n.words||[]).filter(t=>!t.singleLine),l=r(o.map(t=>t.text||"").join(""));for(let h=0;h<a.length;h++){const c=h+1,d=a[h]||"";let u=t?[]:(n.words||[]).filter(t=>!t.singleLine&&(t?.lineNo||0)===c),f=d.includes("\n")?d.split("\n")[0]||"":d;if(u.length>0){const t=r(u.map(t=>t.text||"").join("")),e=r(f);if(t&&e&&t!==e){-1!==a.findIndex((e,n)=>n!==h&&r(e)===t)&&(u=[])}}0===u.length&&o.length>0&&l&&l===r(f)&&(u=o);let g="";if(!t&&u.length>0){let t=0,e="";const n=r(f);for(const s of u){const i=Math.max(0,Math.round(s.duration||0)),a=s.text&&s.text.length>0?s.text:"​",o=r(e+a);if(n&&o.length>n.length)break;if(n&&!n.startsWith(o))break;if(g+=`${a}(${t},${i})`,t+=i,e=o,n&&e.length===n.length)break}}else{g=`${f&&f.length>0?f:"​"}(0,${i})`}e.push(`[${s},${i}]${g}`)}}const n=e.join("\n"),s=`<?xml version="1.0" encoding="utf-8"?>\n<QrcInfos>\n  <Lyric_1 LyricContent="${i=n,(i||"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}"/>\n</QrcInfos>`;var i;let a=Fr(s);if(a.length%8!=0)for(let t=0;t<64;t++){const e=s+`\n\x3c!--p${"x".repeat(t+1)}--\x3e`,r=Fr(e);if(r.length%8==0){a=r;break}}const o=(t,e,r)=>{const n=Array.from({length:16},()=>new Uint8Array(6));tn(e,n,r);const s=new Uint8Array(8*Math.ceil(t.length/8));let i=0;for(let e=0;e<t.length;e+=8){const r=t.subarray(e,Math.min(e+8,t.length));const a=en(8===r.length?r:(()=>{const t=new Uint8Array(8);return t.set(r),t})(),n);s.set(a,i),i+=8}return s},l=cn((t=>{const e=(new TextEncoder).encode(an).slice(0,8),r=(new TextEncoder).encode(on).slice(0,8),n=(new TextEncoder).encode(ln).slice(0,8),s=o(t,n,1),i=o(s,r,0);return o(i,e,1)})(a));return hn(nn+dn(l,sn)).buffer}}class wn{#_=new Map;#m=[];#w=new WeakSet;get metadata(){return this.#_}get lines(){return this.#m}get isEmpty(){return 0===this.#_.size&&0===this.#m.length}constructor(t){if(1!==arguments.length)throw new TypeError("参数数量必须为 1");if("object"!=typeof t||!(t instanceof ArrayBuffer))throw new TypeError("参数 1 必须为 ArrayBuffer 实例");this.#b();const e=[_n,Or,Yr,u];for(let r=0;r<e.length;r++)try{if(e[r].parse(this,t),!this.isEmpty)return}catch{this.#b()}if(this.isEmpty)throw new SyntaxError}static async createFromUri(t){if(1!==arguments.length)throw new TypeError("参数数量必须为 1");if("string"!=typeof t)throw new TypeError("参数 1 必须为字符串");const e=await fetch(t),r=await e.arrayBuffer();return new wn(r)}static supportsPerWord(t){if(!t)return!1;if(!0===t.pseudoPerWord)return!0;if("function"==typeof t.hasPerWordTiming)return t.hasPerWordTiming();return(t.words||[]).some(t=>(t?.duration||0)>0&&!t.singleLine)}static generate(t,e){switch(e){case"lrc":return g.generate(t);case"trc":return f.generate(t);case"qrc":return mn.generate(t);case"krc":return Pr.generate(t);case"ksc":return qr.generate(t);default:throw new TypeError("不支持的歌词格式："+e)}}setCurrentTime(t){if("number"!=typeof t||Number.isNaN(t)||!Number.isFinite(t)||t<0)throw new TypeError("参数 1 必须为非负数");const e=t+(("number"==typeof this.#_.get("offset")?this.#_.get("offset"):0)||0),r=this.#m;if(0===r.length)return{lineIndex:-1,wordIndex:-1};for(const t of r)if(!this.#w.has(t)){const e=t.words.map(t=>{const e=new n;return e.text=t.text,e.duration=t.duration,e.progress=t.progress,e.singleLine=t.singleLine,e.lineNo=t.lineNo,e.state=t.state??"future",e});t.words=e,this.#w.add(t)}let s=-1;if(e>=r[0].startTime){let t=0,n=r.length-1;for(;t<=n;){const i=t+n>>1;r[i].startTime<=e?(s=i,t=i+1):n=i-1}}let i=null;if(s<0)i=null;else{const t=r[s];i=e<t.startTime+t.duration?s:r.length}let a=null===i?0:i>=r.length?r.length-1:i,o=-1;for(let t=0;t<r.length;t++){const n=r[t];if(null!==i)if(i>=r.length){n.state="past",n.progress=1,n.renderProgress=wn.supportsPerWord(n)?0:1;for(const t of n.words)t.state="past",t.progress=1}else if(t<i){n.state="past",n.progress=1,n.renderProgress=wn.supportsPerWord(n)?0:1;for(const t of n.words)t.state="past",t.progress=1}else if(t===i){n.state="current",n.duration>0&&Number.isFinite(n.duration)?n.progress=Math.min(1,Math.max(0,(e-n.startTime)/n.duration)):n.progress=0,n.renderProgress=wn.supportsPerWord(n)?0:n.progress;let r=n.startTime;for(let t=0;t<n.words.length;t++){const s=n.words[t];if(s.singleLine){const t=n.startTime+n.duration;e<n.startTime?(s.state="future",s.progress=0):e>=t?(s.state="past",s.progress=1):(s.state="current",s.progress=Math.min(1,Math.max(0,(e-n.startTime)/(n.duration||1/0))))}else if(s.duration<=0){e<r?(s.state="future",s.progress=0):(s.state="past",s.progress=1)}else{const t=r,n=r+s.duration;e<t?(s.state="future",s.progress=0):e>=n?(s.state="past",s.progress=1):(s.state="current",s.progress=(e-t)/(s.duration||1))}r+=s.duration}if(t===a){const t=n.words;let e=t.findIndex(t=>"current"===t.state);if(-1===e&&t.length){for(let r=t.length-1;r>=0;r--)if("past"===t[r].state){e=r;break}-1===e&&(e=0)}o=e}}else{n.state="future",n.progress=0,n.renderProgress=0;for(const t of n.words)t.state="future",t.progress=0}else{n.state="future",n.progress=0,n.renderProgress=0;for(const t of n.words)t.state="future",t.progress=0}}return{lineIndex:a,wordIndex:o}}#b(){this.#_.clear(),this.#m.length=0,this.#w=new WeakSet}}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var n={};r.d(n,{A:function(){return o},k:function(){return a}});var s=r(507);const i=document.createElement("template");i.innerHTML='\n  <style>\n    :host{ display:block; position:relative; }\n    .wrapper{ position:relative; height:100%; overflow:hidden; background: var(--bg, transparent); user-select:none; -webkit-user-select:none; -ms-user-select:none; touch-action:none; overscroll-behavior: contain; }\n    .inner{ position:absolute; left:0; width:100%; top:50%; will-change:transform; text-align:var(--align, center); z-index:0; user-select:none; -webkit-user-select:none; -ms-user-select:none; }\n    .row{ font-size: var(--font-size, 24px); line-height: 1; padding:4px 0; margin:0; color:#5f6368; }\n    .row.active{ color: var(--colorHighlight, #fff); font-weight:600; }\n    .sub{ display:block; line-height:1.35; }\n    .sub.secondary{ margin-top:4px; font-size:.78em; color: var(--colorTranslation, #8a8f95); }\n    .wordFrame.line-grad{ background-clip:text; -webkit-background-clip:text; color: transparent; }\n    .w{ display:inline; white-space:pre-wrap; position:relative; padding:0; margin:0; letter-spacing:0; }\n    .w.done{ color: var(--colorAfter, #ffb347); }\n    .w.future{ color: var(--colorBefore, #42d392); }\n    .w.current{ background-clip:text; -webkit-background-clip:text; color:transparent; font-weight:600; }\n    .segline{ display:block; white-space:pre; }\n    .segline-clip{ background-clip:text; -webkit-background-clip:text; color:transparent; }\n    .refline{ position:absolute; left:0; right:0; top:50%; transform: translateY(-0.5px); border-top: 1px dashed var(--reflineColor, rgba(255,255,255,.16)); pointer-events:none; z-index:1; }\n    .refline.hidden{ display:none; }\n    /* Overlay slots aligned to the reference line */\n    .refslots{ position:absolute; left:0; right:0; top:50%; transform: translateY(-50%); display:flex; align-items:center; justify-content:space-between; padding: 0 8px; pointer-events:none; z-index:2; }\n    .refslots.hidden{ display:none; }\n    .refslot{ pointer-events:auto; display:flex; align-items:center; gap:6px; }\n    .refslot[part="ref-center"]{ justify-content:center; margin: 0 auto; }\n  </style>\n  <div class="wrapper" part="wrapper">\n    <slot name="before"></slot>\n    <div class="inner" part="inner"></div>\n    <div class="refline" part="refline"></div>\n    <div class="refslots" part="refslots">\n      <div class="refslot" part="ref-left"><slot name="ref-left"></slot></div>\n      <div class="refslot" part="ref-center"><slot name="ref-center"></slot></div>\n      <div class="refslot" part="ref-right"><slot name="ref-right"></slot></div>\n    </div>\n    <slot name="after"></slot>\n  </div>\n';class a extends HTMLElement{static get observedAttributes(){return["src","gradient","align","font-size","line-gap","scroll-ms","show-lang1","show-lang2","show-refline","style","class"]}#y;#x;#v;#k;#A;#T=null;#m=[];#S=-1;#L=0;#E=!0;#z=280;#R;#M=!1;#F=0;#$=0;#I=null;#D=[];#C=-1;#N=!1;#U;constructor(){super(),this.#y=this.attachShadow({mode:"open"}),this.#y.appendChild(i.content.cloneNode(!0)),this.#x=this.#y.querySelector(".inner"),this.#v=this.#y.querySelector(".wrapper"),this.#k=this.#y.querySelector(".refline"),this.#A=this.#y.querySelector(".refslots")}connectedCallback(){this.style.setProperty("--align",this.getAttribute("align")||"center"),this.style.setProperty("--font-size",(this.getAttribute("font-size")||"24")+"px"),this.hasAttribute("src")&&this.loadFromUrl(this.getAttribute("src")),"ResizeObserver"in window&&(this.#R=new ResizeObserver(()=>this.#Z()),this.#R.observe(this)),this.#v.addEventListener("wheel",t=>{const e=t;this.#m.length&&(this.#E=!1,this.#L+=e.deltaY,this.#B(),this.#O(!1),this.#N=!0,this.#P(),this.#W(),e.preventDefault(),t.stopPropagation())},{passive:!1}),this.#v.addEventListener("mousedown",t=>{this.#m.length&&(this.#M=!0,this.#F=t.pageY,this.#$=this.#L,this.#E=!1,this.#N=!0,this.#P(),this.#W())}),window.addEventListener("mousemove",t=>{if(!this.#M)return;const e=t.pageY-this.#F;this.#L=this.#$+e,this.#B(),this.#O(!1),this.#W()}),window.addEventListener("mouseup",()=>{this.#M&&(this.#M=!1,this.#N=!1,this.#P(),this.#W())}),this.#v.addEventListener("touchstart",t=>{if(!this.#m.length)return;if(1!==t.touches.length)return void(this.#M=!1);const e=t.touches[0];this.#M=!0,this.#F=e.pageY,this.#$=this.#L,this.#E=!1,this.#N=!0,this.#P(),this.#W(),t.preventDefault(),t.stopPropagation()},{passive:!1}),this.#v.addEventListener("touchmove",t=>{if(!this.#M)return;if(1!==t.touches.length)return;const e=t.touches[0].pageY-this.#F;this.#L=this.#$+e,this.#B(),this.#O(!1),this.#W(),t.preventDefault(),t.stopPropagation()},{passive:!1}),this.#v.addEventListener("touchend",t=>{this.#M&&(0===t.touches.length&&(this.#M=!1),this.#N=!1,this.#P(),this.#W(),t.preventDefault(),t.stopPropagation())},{passive:!1}),this.#v.addEventListener("touchcancel",t=>{this.#M&&(this.#M=!1,this.#N=!1,this.#P(),this.#W(),t.preventDefault(),t.stopPropagation())},{passive:!1}),document.addEventListener("visibilitychange",this.#j),"MutationObserver"in window&&(this.#U=new MutationObserver(t=>{for(const e of t)"attributes"!==e.type||"style"!==e.attributeName&&"class"!==e.attributeName||this.#H()}),this.#U.observe(this,{attributes:!0,attributeFilter:["style","class"]})),this.#P()}disconnectedCallback(){this.#R?.disconnect(),document.removeEventListener("visibilitychange",this.#j),this.#U?.disconnect()}attributeChangedCallback(t,e,r){"align"===t&&r&&this.style.setProperty("--align",r),"font-size"===t&&r&&this.style.setProperty("--font-size",`${parseInt(r)||24}px`),"src"===t&&r&&this.loadFromUrl(r),"line-gap"===t&&this.#Z(),"scroll-ms"===t&&r&&(this.#z=Math.max(0,parseInt(r)||0)),"gradient"===t&&this.#H(),"show-lang1"!==t&&"show-lang2"!==t||this.#Z(),"show-refline"===t&&this.#P(),"style"!==t&&"class"!==t||this.#H()}setColors(t){t.before&&this.style.setProperty("--colorBefore",t.before),t.after&&this.style.setProperty("--colorAfter",t.after),t.highlight&&this.style.setProperty("--colorHighlight",t.highlight),t.translation&&this.style.setProperty("--colorTranslation",t.translation),this.#H()}async loadFromUrl(t){const e=await fetch(t),r=await e.arrayBuffer();this.loadFromBuffer(new Uint8Array(r))}loadFromText(t){const e=new TextEncoder;this.loadFromBuffer(e.encode(t))}loadFromBuffer(t){try{this.clear();const e=new ArrayBuffer(t.byteLength);new Uint8Array(e).set(t),this.#T=new s.A(e),this.#m=this.#T.lines,this.#S=-1,this.#L=0,this.#x.style.transform="translateY(0)",this.#Y()}catch(t){}}clear(){this.#T=null,this.#m=[],this.#x.innerHTML="",this.#S=-1,this.#C=-1,this.#L=0,this.#x.style.transform="translateY(0)"}setCurrentTime(t){if(this.#T)try{const e=s.u.updateByTime(this.#T,1e3*t),r=this.#S,n=e?.lineIndex??-1,i=e?.wordIndex??-1,a=n>=0&&(s.A.supportsPerWord?.(this.#m[n])??!1);n!==r&&(this.#S=n,this.#q("linechange",{index:this.#S,previousIndex:r}));const o=this.#C;this.#C=a?i:-1,this.#C!==o&&this.#q("wordchange",{lineIndex:this.#S,index:this.#C}),this.#q("seeked",{time:t}),this.#H(),this.#E&&this.#K()}catch{}}#Y(){if(!this.#m.length)return void(this.#x.innerHTML="");const t=parseInt(this.getAttribute("font-size")||"24")||24,e=this.getAttribute("align")||"center";this.style.setProperty("--align",e),this.style.setProperty("--font-size",t+"px");const r="false"!==(this.getAttribute("show-lang1")??"true"),n="false"!==(this.getAttribute("show-lang2")??"true"),i=this.#V(),a=this.#m.map((a,o)=>{const h=a.words||[],c=a.text||h.map(t=>t.text).join(""),d="string"==typeof a.primaryText?a.primaryText:c.split("\n")[0]||"",u="string"==typeof a.secondaryText?a.secondaryText:c.split("\n")[1]||"",f="function"==typeof s.A.supportsPerWord?s.A.supportsPerWord(a):(h||[]).some(t=>(t?.duration||0)>0&&!t.singleLine);let g="";if(o>0&&(g+=`<div class="gap" style="height:${i}px"></div>`),g+=`<div class="row" part="row" data-line="${o}" style="font-size:${t}px; text-align:${e};">`,r)if(f){g+=`<div class="wordFrame" part="primary" data-kind="primary">${h.filter(t=>!t.singleLine&&(1===(t.lineNo||0)||null==t.lineNo)).map((t,e)=>`<span class="w" part="word" data-word="${e}">${l(t.text||"")}</span>`).join("")||l(d||"")}</div>`}else g+=`<div class="wordFrame line-grad" part="primary" data-kind="primary">${d?l(d):""}</div>`;if(u&&n){const t=h.filter(t=>!t.singleLine&&2===(t.lineNo||0));if(t.length>0){g+=`<div class="wordFrame sub secondary" part="secondary" data-kind="secondary">${t.map((t,e)=>`<span class="w" part="word" data-word2="${e}">${l(t.text||"")}</span>`).join("")}</div>`}else g+=`<div class="wordFrame sub secondary" part="secondary" data-kind="secondary">${l(u)}</div>`}return g+="</div>",g}).join("");this.#x.innerHTML=a,this.#Q(),this.#S>=0&&this.#K(!0),this.#H()}#H(){this.#x.querySelectorAll(".row").forEach((t,e)=>{t.classList.toggle("active",e===this.#S);const r=t.querySelector('.wordFrame[data-kind="primary"]');if(!r)return;const n="false"!==(this.getAttribute("gradient")??"true"),i=this.#m[e],a="function"==typeof s.A.supportsPerWord&&s.A.supportsPerWord(i),o=this.#m[e]?.state||(e===this.#S?"current":"future");if(a)r.classList.remove("line-grad"),r.style.backgroundImage="",e===this.#S?n?this.#G(e,!0):(this.#J(t),r.style.color=""):(this.#J(t),r.style.color="past"===o?"var(--colorAfter, #ffb347)":"var(--colorBefore, #42d392)");else{const t=Math.max(0,Math.min(1,this.#m[e]?.renderProgress||0));n?(this.#X(r),r.querySelector(".segline")?(this.#tt(r,t),r.classList.remove("line-grad"),r.style.backgroundImage="",r.style.color=""):t<=0?(r.classList.remove("line-grad"),r.style.backgroundImage="",r.style.color="var(--colorBefore, #42d392)"):t>=1?(r.classList.remove("line-grad"),r.style.backgroundImage="",r.style.color="var(--colorAfter, #ffb347)"):(r.classList.add("line-grad"),r.style.color="",r.style.backgroundImage=`linear-gradient(to right, var(--colorAfter, #ffb347) ${(100*t).toFixed(2)}%, var(--colorBefore, #42d392) 0%)`)):(r.classList.remove("line-grad"),r.style.backgroundImage="",this.#et(r),e===this.#S?r.style.color="":r.style.color="past"===o?"var(--colorAfter, #ffb347)":"var(--colorBefore, #42d392)")}})}#K(t=!1){if(this.#S<0)return;const e=s.u.computeScrollTarget(this.#D,this.#V(),this.#S);this.#L=e,this.#O(!t)}#O(t){t&&this.#z>0?this.#x.style.transition=`transform ${this.#z}ms linear`:this.#x.style.transition="none",this.#x.style.transform=`translateY(${this.#L}px)`}#Q(){const t=Array.from(this.#x.querySelectorAll(".row"));this.#D=t.map(t=>t.getBoundingClientRect().height)}#V(){return parseInt(this.getAttribute("line-gap")||"20")||20}#Z(){const t=this.#S;this.#Y(),this.#Q(),t>=0&&(this.#L=s.u.computeScrollTarget(this.#D,this.#V(),t),this.#O(!1)),this.#H()}#W(){this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#E=!0,this.#K(),this.#N=!1,this.#P()},3e3)}#G(t,e){const r=this.#x.querySelectorAll(".row")[t];if(!r)return;const n=r.querySelector('.wordFrame[data-kind="primary"]');if(!n)return;const s=n.querySelectorAll(".w[data-word]"),i=this.#m[t];s.forEach(t=>{t.classList.remove("done","future","current"),t.style.backgroundImage="",t.style.color="";const r=parseInt(t.getAttribute("data-word")||"-1"),n=i?.words?.filter(t=>!t.singleLine&&(1===(t.lineNo||0)||null==t.lineNo))[r];if(n)if("past"===n.state)t.classList.add("done");else if("future"===n.state)t.classList.add("future");else if(e){t.classList.add("current");const e=(100*(n.progress||0)).toFixed(2);t.style.backgroundImage=`linear-gradient(to right, var(--colorAfter, #ffb347) ${e}%, var(--colorBefore, #42d392) 0%)`}else t.classList.add("current"),t.style.backgroundImage="",t.style.color=getComputedStyle(this).getPropertyValue("--colorHighlight")?.trim()||"#fff"})}#J(t){t.querySelectorAll(".w").forEach(t=>{t.classList.remove("done","future","current"),t.style.backgroundImage="",t.style.color=""})}#X(t){if(!t||"1"===t.dataset?.segReady)return;if(t.querySelector(".w"))return;const e=Array.from(t.childNodes).find(t=>3===t.nodeType),r=t.textContent||"";if(!e||!r)return;const n=e.length;if(0===n)return;const s=new Map,i=(t,r)=>{const n=`${t}:${r}`;if(s.has(n))return s.get(n);const i=document.createRange();i.setStart(e,t),i.setEnd(e,Math.max(t+1,r));const a=i.getClientRects(),o=a.length?a[a.length-1].top:0;return s.set(n,o),o},a=[];let o=0;for(;o<n;){const t=i(o,o+1);let e=o+1,s=n,l=e;for(;e<=s;){const r=Math.floor((e+s)/2),n=i(o,r);Math.abs(n-t)<1?(l=r,e=r+1):s=r-1}a.push(r.slice(o,l)),o=l}t.innerHTML=a.map((t,e)=>`<span class="segline" data-seg="${e}">${l(t)}</span>`).join(""),t.dataset=Object.assign(t.dataset||{},{segReady:"1"})}#tt(t,e){if(!t)return;this.#X(t);const r=Array.from(t.querySelectorAll(".segline"));if(!r.length)return;const n=r.map(t=>t.getBoundingClientRect().width),s=n.reduce((t,e)=>t+e,0)||1,i=Math.max(0,Math.min(1,e||0))*s;let a=0;r.forEach((t,e)=>{const r=n[e]||1,s=a,o=a+r;if(i<=s+.01)t.classList.remove("segline-clip"),t.style.backgroundImage="",t.style.color="var(--colorBefore, #42d392)";else if(i>=o-.01)t.classList.add("segline-clip"),t.style.color="",t.style.backgroundImage="linear-gradient(to right, var(--colorAfter, #ffb347) 100%, var(--colorBefore, #42d392) 0%)";else{const e=(100*((i-s)/r)).toFixed(2);t.classList.add("segline-clip"),t.style.color="",t.style.backgroundImage=`linear-gradient(to right, var(--colorAfter, #ffb347) ${e}%, var(--colorBefore, #42d392) 0%)`}a+=r})}#et(t){t.querySelectorAll(".segline").forEach(t=>{t.classList.remove("segline-clip"),t.style.backgroundImage="",t.style.color=""})}#B(){if(!this.#D.length)return;const t=s.u.computeScrollClamp(this.#D,this.#V(),50),e=t.min,r=t.max;this.#L<e&&(this.#L=e),this.#L>r&&(this.#L=r)}#j=()=>{"visible"===document.visibilityState&&(this.#H(),this.#E?this.#K(!0):this.#O(!1))};scrollToCurrent(t=!1){this.#K(t)}#q(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e}))}#P(){if(!this.#k)return;const t=this.getAttribute("show-refline");if("true"===t)this.#k.classList.remove("hidden"),this.#A?.classList.remove("hidden");else if("false"===t)this.#k.classList.add("hidden"),this.#A?.classList.add("hidden");else{const t=this.#M||this.#N||!!this.#I;this.#k.classList.toggle("hidden",!t),this.#A?.classList.toggle("hidden",!t)}}}customElements.define("jyo-lyric",a);const o=a;function l(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;"};return t.replace(/[&<>]/g,t=>e[t]||t)}const h=n.k,c=n.A;export{h as JyoLyricElement,c as default};